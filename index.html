
<!DOCTYPE HTML>
<html>
<head>
	<script data-cfasync="false" type="text/javascript" src="//use.typekit.net/axj3cfp.js"></script>
	<script data-cfasync="false" type="text/javascript">try{Typekit.load();}catch(e){}</script>
	<meta charset="utf-8">
	<title>Ember.js, random thoughts, journal  | machty's thoughtz</title>

<meta name="author" content="Alex Matchneer"> 

<meta name="description" content="I'm on Ember core and contribute to lots of stuff prefixed with "Em"."> <meta name="keywords" content="">

	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="machty's thoughtz" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<script type="text/javascript" src="/javascripts/jquery.fancybox.pack.js"></script>

<script language="Javascript" type="text/javascript">
$(document).ready(
  function() {
    (function($) {
      $(".fancybox[data-content-id]").each(function() {
        this.href = $(this).data('content-id');
      });
      $(".fancybox").fancybox({
        beforeLoad: function() {
          var el, 
              id = $(this.element).data('title-id');

          if (id) {
            el = $('#' + id);

            if (el.length) {
              this.title = el.html();
            }
          }
          if ($(this).data('content')) {
            this.content = $(this).data('content');
          }
        },
        helpers: {
          title: {
            type: 'inside'
          }
        }
      });
    })(jQuery);
  }
);
</script>

	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">machty's thoughtz</a></h1>
<h4>Ember.js, random thoughts, journal</h4>
<nav id="main-nav"><ul>
	<li><a href="/">Blog</a></li>
	<li><a href="/archives">Archive</a></li>
	<li>
    <span>
    <a href="http://www.cram.com/flashcards/alexmatchneercom-4692833" target="_blank">Flashcards</a>
    </span>
    <span>
    (<a href="/blog/2014/04/12/blog-flashcards/">explanation</a>)
    </span>
  </li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul>
	<li><a href="/">Blog</a></li>
	<li><a href="/archives">Archive</a></li>
	<li>
    <span>
    <a href="http://www.cram.com/flashcards/alexmatchneercom-4692833" target="_blank">Flashcards</a>
    </span>
    <span>
    (<a href="/blog/2014/04/12/blog-flashcards/">explanation</a>)
    </span>
  </li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:machty.github.com">
			</form>
		</div>
	</div>
</nav>


</header>

	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/12/29/tarpit/">
		
			Tarpit</a>
	</h2>
	<div class="entry-content">
		<p>Notes from tarpit reading: http://shaffner.us/cs/papers/tarpit.pdf</p>

<p>OOP: intentionally couple state to related behavior</p>

<p>No Silver Bullet, what makes software hard: Complexity, Conformity, Changeability, Invisibility</p>

<p>Dijkstra: testing is hopelessly inadequate&#8230; it can be used very effectively to show the presence of bugs but never to show their absence.</p>

<p>State hinders Informal Reasoning, reasoning about expected behavior from the inside, with knowledge of internal code.</p>

<p>Control Complexity: complexity due to having to be concerned about the order of events. Languages with explicit flow control make you think about this.</p>

<p>a = b + 3
c = d + 2
e = f * 4</p>

<p>No reason for this flow, but programmer has to over-specify it (and compilers have to go to lengths to know that the order can be safely ignored). Accidental complexity:</p>

<ol>
<li>artificial, totally ignorable ordering imposed on programmer</li>
<li>compiler work is done to optimize it away</li>
</ol>


<p>Note that these two forms of complexity only apply given the assumption that the above code is for an imperative language with guarantees about order of execution; Oz is an example of a programming language that didn&#8217;t specify this.</p>

<p>&#8220;Running a test in the presence of concurrency with a known initial state and set of inputs tells you nothing at all about what will happen the next time you run that very same test with the very same inputs and the very same starting state&#8230; and things can’t really get any worse than that.&#8221;</p>

<p>CLOS: Common Lisp Object System, with multiple dispatch (methods can specialize on any/all required arguments, unlike classic OOP single dispatch).</p>

<p>Problems with OOP encapsulation:</p>

<ul>
<li>access to state can still be spread all over the place, e.g. in presence of inheritance</li>
<li>encapsulation strongly biased toward single-object constraints; not a lot of help in coordinating multiple object states</li>
</ul>


<p>Identity and State</p>

<p>Object identity: in OOP, each object is considered uniquely identifiable regardless of attributes. This is intensional identity (as opposed to extensional where objects are the same if their attributes are). Intensional identity opposes relational algebra view of the world.</p>

<p>But OOP is complicated when mutability isn&#8217;t needed, and you add concepts like Value Objects where equality is based on values and not identity (in other words, it brings back extensional identity).</p>

<p>https://en.wikipedia.org/wiki/Value_object</p>

<p>Immutable small objects whose equality is not based on identity. In int is an int forever, but objects can be mutated, so if you want an object that acts like, say, an int, you want a value object.</p>

<p>TL;DR C++ has copy-by-value because C does, hence both support value objects. Java has no native support for value objects, but you can get a functionally similar/equivalent thing by passing around references to immutable objects (VALJO, VALue Java Object, where all attributes of the obj are final and doesn&#8217;t contain other objects w mutable state).</p>

<p>Object Identity exists because state exists, and is a source of error due to mental switching between the meaning of equality. (TODO: why isn&#8217;t this a problem in Clojure? You have to mentally switch between values and atoms&#8230; how is that any different?).</p>

<p>Hmm I feel like there&#8217;s something I&#8217;m not quite grasping about what people mean when they say state. Seems like everything has state? I dunno.</p>

<p>Summary: conventional OOP suffers from state-derived and control-derived complexity.</p>

<p>Functional Languages</p>

<p>Pure: Haskell. Impure: ML, in that it advocates avoiding but still permits state.</p>

<p>Referential transparency: an expression (e.g. function calls) are replaceable by a value&#8230; nope, i guess it&#8217;s just that a function called with the same args will always return the same value.</p>

<p>Control:</p>

<p>Still an implicit left-to-right sequencing of operations, but fortunately control flow like loops are avoided in favor of fold/map.</p>

<p>Kinds of state</p>

<p>When most people talk about state they really mean mutable state.</p>

<p>Stateful methods can be replaced by functions where the state is passed in, and a new version of the state is returned, with the expectation that the new state must be passed in again to future calls (because referential transparency means the same function invocation always returns the same thing).</p>

<p>This paper seems to distinguish b/w procedures and functions based on a procedure having state&#8230; it runs and can manipulate inner state. But a functional only returns values based on what was passed in and has new inner state.</p>

<p>BUT, this is just using FP to simulate state. In principle, you could build functional programs by just passing in the global god state of the app into every function and just chaining it along, which brings back the problem of single pool of global variables. Ref transparency++, ease of reasoning&#8211;. But this is an extreme example.</p>

<p>Argument: state increases modularity:</p>

<p>&#8220;Working within a stateful framework it is possible to add state to any component without adjusting the components which invoke it.&#8221;</p>

<p>With FP, you have ripple effects where adding &#8220;state&#8221; to a function means that state needs to be provided by a caller of a caller of a caller, etc, e.g. adding that extra state parameter.</p>

<p>It&#8217;s a tradeoff between hiding state and FP where you know exactly what will happen.</p>

<p>But in stateful PLs, you never know if there will be side-effects; you have to inspect all code to really know.</p>

<p>&#8220;As with the discipline of (static) typing, it is trading a one-off up-front cost for continuing future gains and safety (“one-off” because each piece of code is written once but is read, reasoned about and tested on a continuing basis).&#8221;</p>

<p>In other words, it&#8217;s convenient in the moment to have state (the one-off time you write that stateful code), but for all future readers/reasoners, they have to deal with the fallout of losing the guarantee of statelessness.</p>

<p>Monads are kind of a way to have the cake and it it too, but makes it possible to create a stateful sub-language within Haskell, even if technically it&#8217;s properly typed as such. But still, monads have been insufficient in helping widespread FP adoption.</p>

<p>Logic Programming</p>

<p>State your axioms and desired goals, let the system build the formal proof for each solution. Prolog is seminal logic PL.</p>

<p>&#8220;It is worth noting that a single Prolog program can be both correct when read in the first way, and incorrect (for example due to non-termination) when read in the second.&#8221;</p>

<p>This is because Prolog axioms aren&#8217;t read as purely logical axioms but are applied sequentially, which is why the order of axioms can affect the outcome.</p>

<p>Control issues</p>

<p>LTR and top to bottom dependencies exist. Also, extra-logical features such as cuts (which prevent a restriction of control flow, presumably to prevent non-termination) add complexity.</p>

<p>Oz gives you flexibility of control rather than depth-first prolog, but rather than sprinkling these into the code, it&#8217;s at a separate level; in other words, the way you execute code is configurable, not within the code itself (a contamination of control complexity).</p>

<p>Classifying state:</p>

<p>Goal: determine origins of state, hope that most state turns out to be accidental.</p>

<p>All data is either directly provided to system (input) or derived.</p>

<p>Derived data is either immutable (used only for display) or mutable (because requirements specify user should update that data)</p>

<p>But just because all user input data is essential does not mean it must result in essential state. If it&#8217;s avoidable, it&#8217;s accidental state.</p>

<p>Input Data:</p>

<ul>
<li>there&#8217;s a possibility of referring to that data in the future: essential state</li>
<li>there is no possibility (e.g. it&#8217;s used to cause some side effect but then can be forgotten)</li>
</ul>


<p>Essential Derived Data - immutable</p>

<p>Always rederivable, accidental state if stored.</p>

<p>Essential Derived Data - mutable</p>

<p>I don&#8217;t understand this.</p>

<p>Accidental Derived Data</p>

<p>Ideal world:</p>

<p>No caches, no stores of derived calculations of any kind. Result: all state is visible to the user (or tester) of the system, since (disallowed) caching is the main source of hidden state. If you&#8217;re not caching, then everything you calculate is presented to the user.</p>

<p>Control</p>

<p>Control is accidental since it&#8217;s rare if ever that requirements are a view of execution.</p>

<p>Concurrency is accidental; assuming zero time computation, user doesn&#8217;t care whether something happens in sequence or parallel.</p>

<p>Real world</p>

<ul>
<li>state is required because most systems have state as part of their true essence (wtf does this mean?)</li>
<li>control is accidental, but practically (and for efficiency purposes) it is needed, same goes w state (caching and what not)</li>
</ul>


<p>Formal Specification</p>

<ul>
<li>property-based: <em>what</em> is required rather than how. Includes algebraic approaches such as Larch and OBJ</li>
<li>model-based / state-based: construct a model, often stateful, and specify how it must behave. Implies a stateful approach for how to solve the problem.</li>
</ul>


<p>Sometimes ideal world approach (no accidental state, derive everything) does not best model program. Example: derived data is dependent on both series of user inputs over time, AND its own previous values. In such a case it can help to maintain accidental state (I don&#8217;t get this&#8230; why is this different than the conveniences of storing derived state that isn&#8217;t strictly historical?). Example: position of computer controlled opponent in interactive game: technically position is derivable as f(initialPosition, allMovementsSince), but &#8220;this is not the way it is most naturally expressed&#8221;. Go fuck yourself and your loose definition of what is natural.</p>

<p>Required Accidental Complexity:</p>

<ul>
<li>perf

<ul>
<li>avoid explicit management of accidental state; instead: simply declare what accidental state should be use, leave to separate infrastructure to maintain.</li>
</ul>
</li>
<li>ease of expression: (e.g. position of computer controlled opponent)

<ul>
<li>solution: pretend user is typing in this derived state, i.e. pretend that it is essential input</li>
</ul>
</li>
</ul>


<p>Relational Model</p>

<ul>
<li>structure of data</li>
<li>manipulating data</li>
<li>maintaining integrity and consistency of state</li>
<li>insistence on separation b/w logical and physical layers of system</li>
</ul>


<p>Data independence: app / logical model is separate from the data is actually stored</p>

<p>Structure: use of relations to represent all data
Manipulation: a means to specify derived data
Integrity: constraints
Data Independence: clear separation is enforced b/w logical data and physical representation</p>

<p>Base Relations: raw tables
Derived Relations: Views: defined in terms of other relations</p>

<p>Access path independence:</p>

<p>Relational structuring allows you to defer access paths (how the data will be queried, join, etc). Before relational model, you had to decide up front, e.g, whether employees would live inside top level departments, or departments within top level employees. This is the hierarchical approach. The network approach is a little better in that you can add cycles but in the end you&#8217;re still defining the primary retrieval requirements up front at the expense of not knowing what secondary/future retrieval requirements you&#8217;ll have. Again, joining is the canonical example.</p>

<p>OOP and XML suffer same hierarchical problems. Nesting. Who owns what. etc.</p>

<p>Manipulation: relational algebra</p>

<p>Restrict: unary operation for selecting subset (where clause?)
Project: unary op which creates a new relation w various attributes removed (not added?)
Product: cartesian product of tables (e.g. SELECT FROM foo, wat;)
Union: binary operation, creates relation w all records in either arg relation
Intersection: binary operation, creates a relation consisting of all records in both
Difference: xor
Join: binary operation construction all possible records that result from identical attrs
Divide: ternary operation returning all records of first arg with occur in second arg associated w each record of 3rd arg (wat?</p>

<p>Functional Relational Programming</p>

<p>All essential state comes in the form of relations, and essential logic is expressed using relational algebra extended w pure user defined functions</p>

<p>Step 1, specify each of the following</p>

<p>Essential State: relational definition of stateful components
Essential Logic: Derived-relation defitions, integrity constraints, and pure functions
Accidental State and Control: declarative specification of a set of perf optimizations for the system
Other: user and system interfaces for the outside world</p>

<p>Essential state</p>

<p>Relations, tables, columns (the schema, not actual rows/records)
Data should only be considered essential if directly input by user.</p>

<p>Essential Logic</p>

<p>Pure functions about data transformation, set of db constraints.</p>

<p>Note that we ignore &#8220;denormalization for perf&#8221; for now because we&#8217;re just talking about formal specifications; the physical storage may or may not mirror what&#8217;s being specified here.</p>

<p>Accidental State and Control</p>

<p>Specify 1) what state should exist, 2) what physical storage mechanism used</p>

<ul>
<li>state-related hint: e.g. some derived-relvar should be stored rather than recalculated</li>
<li>second kind of state-related hint: infrequently used subset of relvar should be stored elsewhere (e.g. partitioning a table)</li>
</ul>


<p>Control side:</p>

<ul>
<li>tweaking the evaluator</li>
</ul>


<p>TL;DRs:</p>

<p>Declarative lets infrastructure optimize for you, e.g. avoid relational <code>intersection</code> if it can be determined that two groups are mutually exclusive, not possible/easy with imperative.</p>

<p>Normalized relational everything: avoids subjective bias about data access paths. OOP and XML generally force you to do the opposite, choosing nestings ahead of time and other things.</p>

<p>Control is <em>avoided</em>  relational approach (think of SQL; no order of evaluation; this is intentional).</p>

<p>Explicit parallelism is avoided, but allows for possibility for separated accidental control if required; whether it&#8217;s parallel or not shouldn&#8217;t matter to anyone other than implementor, i.e. if it really improves things, it&#8217;ll be parallel, but functionally it&#8217;s the same interface for infrastructure consumers.</p>

<p>Code Volume</p>

<p>Focus on true essentials avoids accidental complexity.</p>

<p>Data Abstraction</p>

<p>Creation of compound data types; to be avoided. Why:</p>

<ul>
<li><p>Subjective: like baking in data paths in OOP/XML-ish representation of data, is brittle to future use cases. Pre-existing bias will force future use cases into inappropriate reuse of pre-established biased structures. (I like this; this is a source of refactors, when you know what you&#8217;re doing is gross because of some new use case)</p></li>
<li><p>Data Hiding: constructing giant objects often causes unneeded, irrelevant data to be supplied to function, and <em>which</em> data actually gets used is hidden at call site, hurts informal reasoning and testability. Avoiding composite objects helps avoiding this problem.</p></li>
</ul>


<p>FRP (func rel) opens door to</p>

<ul>
<li>perf (decided by infrastructure)</li>
<li>different dev teams focusing on different components (by components we mean accidental vs essential vs interfacing)&#8230; this arg seems weak, or i don&#8217;t really understand it</li>
</ul>


<p>Allowed Types</p>

<p>Can create limited types for essential state/logic components:</p>

<ul>
<li>disjoint union / enumeration types</li>
<li>NO product types (types w subsidiary components)</li>
</ul>


<p>https://en.wikipedia.org/wiki/Algebraic_data_type</p>

<p>Algebraic data type is a kind of composite type; type formed by combining other types. Product types (tuples and records), and sum types (disjoint unions or variant types). So you can have things like</p>

<p>Action = UserClickEvent | UserDragEvent | Blah</p>

<p>This is a sum type; the total values an Action could be are the total possible values of its variants, summed.</p>

<p>A Product type is, say, a type, e.g. (Int, String), where the total possible values are all the possible values of variants, multiplied (hence product).</p>

<p>Why sum and not product? because Sums don&#8217;t add new data types, really, they just categorize for pattern matching and other things. Whereas products create new compound datatypes.</p>

<p>Example app</p>

<p>Derived internal relations:</p>

<ul>
<li>RoomInfo, extend(Room, (roomSize = width*breadth))

<ul>
<li>so it&#8217;s a room info with another type</li>
</ul>
</li>
<li>Acceptance takes accepted Decisions and strips away accepted bool. So an Acceptance is a Decision without an accepted flag. I like this because we&#8217;re keeping the domain simple; if we&#8217;re dealing with Acceptances, we don&#8217;t have to worry that it&#8217;s an acceptance that&#8217;s not an acceptance; the domain is constrained properly.</li>
<li>Rejection is the opposite, but has the same attrs</li>
</ul>


<p>Accidental state and control</p>

<p>This part is interesting because it suggests that defining relations (like you do when designing/committing a DB schema) is a premature accidental complexity. This paper suggests that you take your essential state types and hint that some of them should be cached. In relational databases, if you CREATE TABLE, you&#8217;re creating a cache. I guess this should be obvious. But the thing to note is that what this paper is suggesting is that there is a level above this at which we should be thinking. Everything below is accidental. Whether you CREATE TABLE or recompute on the fly is accidental. The user doesn&#8217;t care.</p>

<p>So, hints:</p>

<p>declare store PropertyInfo : create a cache / table for PropertyInfo rather than re-calc</p>

<p>declare store shared Room Floor : denormalize Room and Floor into shared storage structure (hmm, why? is this a join table?)</p>

<p>declare store separate Property (photo) : split out photo from other properties (perf hint).</p>

<p>TODO: read Kow79</p>

<p>Simple Made Easy</p>

<p>Classes as namespaces = bad.</p>

<p>Syntax is inferior to data.</p>

<p>Switching/pattern matching allegedly complects multiple pairs of who&#8217;s going to do something and what happens&#8230; how is this different than multi-methods?</p>

<p>variables complect value and time (they are state i guess)</p>

<p>for loops complecting by explicitly specifying how to do something.</p>

<p>folds still complect because they go from left to right&#8230;</p>

<p>Polymorphism a la cart, via Clojure protocols. 1) define data structures, 2) definitions of sets of functions, and 3) connect them together.</p>

<p>Favor declarative Prolog-ish logic programming to littering conditionals all over the place.</p>

<p>Resource contention is inherent complexity, not your fault.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-12-29T09:41:00-05:00" pubdate data-updated="true">Dec 29<span>th</span>, 2015</time></div>
	


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/08/30/identizzle/">
		
			Identizzle</a>
	</h2>
	<div class="entry-content">
		<h2>Half-open connections</h2>

<p>http://blog.stephencleary.com/2009/05/detection-of-half-open-dropped.html</p>

<p>TL;DR: if you don&#8217;t write, you have no way of knowing whether your
connection is still alive.</p>

<h2>Does setTimeout wait til until the end of the event loop to start ticking?</h2>

<p>No, it doesn&#8217;t:</p>

<pre><code>  var endOfEventLoop;

  setTimeout(function() {
    console.log("" + (+new Date() - endOfEventLoop) + " ms after end of event loop");
  }, 1000);

  var now = +new Date();
  while((+ new Date()) - now &lt; 900) { /* spin for 900ms */ }
  endOfEventLoop = +new Date();
</code></pre>

<p>yields:</p>

<pre><code>  101ms later
</code></pre>

<p>Why is this important?</p>

<p>Because if you&#8217;re using magic numbers to, say, open a popup after some
animation has occurred, you&#8217;re opening yourself up to disaster / timing
errors if, after setting your timeout, a lot of slow computation /
rendering logic eats up a chunk of that timer.</p>

<h2>Primary Key</h2>

<p>A primary key is just a column with the follow constraints:</p>

<ul>
<li>NOT NULL</li>
<li>UNIQUE</li>
</ul>


<p>Note: you can have multiple NOT NULL / UNIQUE columns, but only one can
be marked as PRIMARY.</p>

<h2>observeOn vs subscribeOn</h2>

<p>http://reactivex.io/documentation/scheduler.html</p>

<blockquote><p>As shown in this illustration, the SubscribeOn operator designates which thread the Observable will begin operating on, no matter at what point in the chain of operators that operator is called. ObserveOn, on the other hand, affects the thread that the Observable will use below where that operator appears. For this reason, you may call ObserveOn multiple times at various points during the chain of Observable operators in order to change on which threads certain of those operators operate.</p></blockquote>

<h1>Roth IRA</h1>

<p>&#8220;IRA&#8221; stannds for Individual Retirement Account.</p>

<p>http://www.rothira.com/roth-ira-taxes-and-tax-issues</p>

<blockquote><p>Roth IRA contributions are not taxed at the time you contribute the funds to your Roth IRA. However, your contributions come from post-tax income. You pay taxes on your income today, but not in the future.</p></blockquote>

<p>What does post-tax income mean? If I make 80k pre-tax, let&#8217;s say my
post-tax income is 60k. If I want to put $5k into a Roth IRA, then I&#8217;m
down to 75k and 55k. OH I get it&#8230; I think. The amount the government
takes from me grows as I make more money. I&#8217;d benefit me if I were able
to put 5k into Roth before I was taxed, so that then my taxable income
would be 75k, and I&#8217;d have to pay the gov less than if I were taxed
based on 80k.</p>

<h1>Random acts of optimization</h1>

<p>http://engineering.riotgames.com/news/random-acts-optimization</p>

<h1>Readline</h1>

<p>TODO: figure out how to get your tmux / bash setup working. Shouldn&#8217;t
be rocket science. Goal: get irb and psql working.</p>

<h1>ORDBMS</h1>

<p>Object-relational database management system. Postgres is this. MySQL is
not; MySQL is just RDBMS.</p>

<blockquote><p>An object-relational database (ORD), or object-relational database management system (ORDBMS), is a database management system (DBMS) similar to a relational database, but with an object-oriented database model: objects, classes and inheritance are directly supported in database schemas and in the query language. In addition, just as with pure relational systems, it supports extension of the data model with custom data-types and methods.</p></blockquote>

<p>An Object Database leverages pointers over joins for collecting data,
where as a the relational approach leverages foreign keys,
denormalizing, and storing everything in tabular format. Pros to Object
Database include no mental model mismatch between your programming model
(often OOP) and database storage; create an obj, modify an obj, save an
obj &#8211; no need to figure out how to express your object in tabular
format.</p>

<p>Disadvantages are that any sort of reporting / querying needs to be
programmed in, whereas relational databases follow set/relational theory
and if you&#8217;ve got things stored in a tabular format you have way more
flexibility to modify / query your database in the future.</p>

<h1>Postgres</h1>

<p>Developed at Berkeley as POSTGRES, pioneered many concepts later adopted by
commercial databases. Sponsored by DARPA. Didn&#8217;t have SQL (btw SQL has
been around since the 70s). SQL added in Postgres95, became PostgreSQL.</p>

<p>Comes with a bunch of binaries:</p>

<p><code>postgres</code> the server; accepts connection and then starts a worker
process to handle that connection. (Can verify this; spinning up a
rails console creates one more postgres worker instance).</p>

<blockquote><p>Thus, the master server process is always running, waiting for client connections</p></blockquote>

<p><code>psql</code> shell looks like <code>mydb=&gt;</code> for regular users, <code>mydb=#</code> for
superuser.</p>

<p>Commands prefixed with <code>\h</code> are not SQL; everything else is SQL.</p>

<p>A relation = mathemtical term for table.</p>

<p>https://en.wikipedia.org/wiki/Relational_model</p>

<p>All data sets represented as tuples, grouped into relations.</p>

<blockquote><p>&#8220;A relation is a data structure which consists of a heading and an unordered set of tuples which share the same type,&#8221;</p></blockquote>

<h1>Deviations of SQL from relational model</h1>

<p>https://en.wikipedia.org/wiki/Relational_model#SQL_and_the_relational_model</p>

<ul>
<li>SQL allows duplicate rows; relational model does not. Practically
though this is avoided by auto-incrementing.</li>
</ul>


<p>SQL apparently also allows anonymous columns, duplicate rows, etc, which
make things impossible to reference due to indistinguishability.</p>

<p>SQL includes &#8220;NULL&#8221; to imply missing data; comparison of NULL with
itself is not true, but NULL. (Comparison of anything with NULL yields
NULL; it means unknown, not determinable). And hence it&#8217;s a form of
three-valued logic, rather than just boolean.</p>

<p>Law of exclude middle: It states that for any proposition, either that proposition is true, or its negation is true.</p>

<p>Relational model depends on this law, but SQL does not, since it allows
for NULL. Apparently Codd (relational model inventor) eventually
suggested a 4-valued logic, probably to differentiate NULL from UNKNOWN,
only to have a bunch of smug guys suggesting 19 or even 21-valued logic.
WAT. So Postgres just stuck w 3 valued logic.</p>

<p>SQL also uses NULL for other things than value unknown: the sum of an
empty set is NULL.</p>

<p>Rows are grouped into tables/relations. Relations grouped into database.
Databases managed by a single Postgres server instance is a cluster.</p>

<h1>Joins</h1>

<pre><code>SELECT * FROM wats, foos;
</code></pre>

<p>Gives you a combination</p>

<pre><code> name | name | wat
------+------+------
 foo1 | bar1 | wat1
 foo1 | bar2 | wat2
 foo2 | bar1 | wat1
 foo2 | bar2 | wat2
 foo3 | bar1 | wat1
 foo3 | bar2 | wat2
</code></pre>

<p>Or even</p>

<pre><code> name | name | wat  | bazname
------+------+------+---------
 foo1 | bar1 | wat1 | baz1
 foo1 | bar1 | wat1 | baz2
 foo1 | bar2 | wat2 | baz1
 foo1 | bar2 | wat2 | baz2
 foo2 | bar1 | wat1 | baz1
 foo2 | bar1 | wat1 | baz2
 foo2 | bar2 | wat2 | baz1
 foo2 | bar2 | wat2 | baz2
 foo3 | bar1 | wat1 | baz1
 foo3 | bar1 | wat1 | baz2
 foo3 | bar2 | wat2 | baz1
 foo3 | bar2 | wat2 | baz2
</code></pre>

<p>If any of those tables had zero rows then zero rows would be selected
even if there&#8217;s data in the other tables.</p>

<blockquote><p>It is widely considered good style to qualify all column names in a
join query, so that the query won’t fail if a duplicate column name
is later added to one of the tables.</p></blockquote>

<p>You could also rewrite the first one as</p>

<pre><code>SELECT * FROM foos INNER JOIN bars ON true;
</code></pre>

<p>So selecting * seems to select from all relations/tables involved.</p>

<p>Aggregate functions can&#8217;t be used in WHERE clauses, since WHERE clauses
are limit the input rows, recursive infinite etc blah blah.</p>

<pre><code>SELECT city FROM weather WHERE temp_lo = max(temp_lo);
</code></pre>

<p>You can change this to a subquery</p>

<pre><code>SELECT city FROM weather
    WHERE temp_lo = (SELECT max(temp_lo) FROM weather);
</code></pre>

<p>Aggregates play nicely with GROUP BY clauses: here&#8217;s how you&#8217;d count
many rows had the same values.</p>

<pre><code>SELECT name, count(*) FROM bars GROUP BY name;
</code></pre>

<p><code>HAVING</code> is like a WHERE clause for grouping / aggregate functions.
Specifically, WHERE filters the input rows, and HAVING filters the
results after aggregation has taken place:</p>

<p>http://stackoverflow.com/a/287496/914123</p>

<h2>Referential integrity</h2>

<p>Making sure foreign keys point to objects in the table.</p>

<h2>Window functions</h2>

<p>Similar to GROUP BY, but instead preserves each input row in the
output set rather than coalescing them down to just one row; in other
words, instead of boiling down to a single answer per group, window
functions add that answer to as a column to each of the input rows.</p>

<pre><code>SELECT depname, empno, salary, avg(salary) OVER (PARTITION BY depname) FROM empsalary;
</code></pre>

<p>Whoa this is pretty awesome:</p>

<pre><code>SELECT depname, empno, salary,
       rank() OVER (PARTITION BY depname ORDER BY salary DESC)
FROM empsalary;
</code></pre>

<p>&#8220;For each row, the window function is computed across the rows that fall into the same partition as the current row.&#8221;</p>

<p>Kinda like how aggregate functions are computed using rows with the same
GROUP BY value.</p>

<p>There partitions and there are window frames&#8230;</p>

<p>A window frame is a subset of a partition (or the whole partition
itself). Many window functions use window frame rows, though some
use partition rows. By default, if ORDER BY is supplied <em>to the
over clause, not the whole query</em>, then the window frame consists
of the all rows from start of the partition through to current row,
plus any following rows that have same ORDER BY value&#8230;</p>

<p>WAT.</p>

<p>There must be some good reason for this. Can&#8217;t think of it now.</p>

<pre><code>SELECT salary, sum(salary) OVER (ORDER BY salary) FROM empsalary;
</code></pre>

<p>But the thing to keep in mind I guess is that the <code>ORDER BY</code> here is
just another way to configure the partition + window frame. Maybe that&#8217;s
the way to think of it: <code>OVER</code> clauses are used to specify both
partitions and window frames all in one shot. PARTITION BY is one way,
that specifies a partition where window frame is the partition, and
ORDER BY is another, where the PARTITION is all the rows (filtered by
WHERE) and window set is from start to current row.</p>

<p>Window functions can only be used in the SELECT list and in ORDER BY. I
guess that makes sense. Can&#8217;t use them in GROUP BY, HAVING, or WHERE,
since they logically execute after those things.</p>

<h2>Aggregate expressions</h2>

<pre><code>---                   direct arguments                   aggregated arguments
aggregate_name ( [ expression [ , ... ] ] ) WITHIN GROUP ( order_by_clause ) [ FILTER ...
</code></pre>

<blockquote><p>The argument expressions preceding WITHIN GROUP, if any, are called direct arguments to distinguish them from the aggregated arguments listed in the order_by_clause. Unlike normal aggregate arguments, direct arguments are evaluated only once per aggregate call, not once per input row.</p></blockquote>

<p>So the stuff in <code>WITHIN GROUP(...)</code> are evaluated once per input row. So
ideally we should minimize the stuff we put in there.</p>

<blockquote><p>This means that they (direct arguments) can contain variables only if those variables are grouped by GROUP BY;this restriction is the same as if the direct arguments were not inside an aggregate expression at all.</p></blockquote>

<pre><code>SELECT percentile_disc(0.5) WITHIN GROUP (ORDER BY income) FROM households;
 percentile_disc
-----------------
           50489
</code></pre>

<p>0.5 is a direct argument; it makes no sense for it to be substituted
with a value that varies across rows.</p>

<p>So for example you could do:</p>

<pre><code>SELECT percentile_disc(0.5) WITHIN GROUP (ORDER BY num) from nums;
 percentile_disc
-----------------
               3
</code></pre>

<p><code>percentile_disc</code> is an aggregate function. It&#8217;s going to spit out
values that are the result of coalescing rows. It wouldn&#8217;t make sense
for me to try and add the column <code>name</code> to this result, because the
<code>percentile_disc</code> result is based on coalesced rows:</p>

<pre><code>SELECT name, percentile_disc(0.5) WITHIN GROUP (ORDER BY num) from nums;
ERROR:  column "nums.name" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: SELECT name, percentile_disc(0.5) WITHIN GROUP (ORDER BY num...
               ^
</code></pre>

<p>The only way that&#8217;d make sense would be to GROUP BY <code>name</code> so that the
aggregate function is only being applied to groups grouped by name
rather than all of the input rows at once:</p>

<pre><code>SELECT name, percentile_disc(0.5) WITHIN GROUP (ORDER BY num) from nums GROUP BY name;
  name  | percentile_disc
--------+-----------------
 alex   |               3
 justin |               2
(2 rows)
</code></pre>

<p>Wow this stuff is weird to talk about.</p>

<p>Note that <code>count</code> is not an &#8220;ordered set&#8221; aggregate:</p>

<pre><code>SELECT name, count(*) WITHIN GROUP (ORDER BY num) from nums GROUP BY name;
ERROR:  count is not an ordered-set aggregate, so it cannot have WITHIN GROUP
LINE 1: SELECT name, count(*) WITHIN GROUP (ORDER BY num) from nums ...
                     ^
</code></pre>

<p>It barfs because I tried to provide a <code>WITHIN GROUP</code> clause to a non
ordered set aggregate <code>count</code>. If I remove my WITHIN GROUP clause, I
get:</p>

<pre><code>SELECT name, count(*) from nums GROUP BY name;
  name  | count
--------+-------
 alex   |     6
 justin |     3
(2 rows)
</code></pre>

<p>So what is an ordered set aggregate? It just means an aggregate fn
whereby performing the computation requires some kind of ordering. My
hunch is that ORDER BY inside of WITHIN GROUP isn&#8217;t used just for
&#8220;sorting&#8221; the rows, but for defining the key by which they&#8217;ll be
grouped. Or that&#8217;s just my bullshit way of fitting it into my brain.</p>

<pre><code>SELECT count(*) as unfiltered, count(*) FILTER (WHERE i &lt; 5) as filtered FROM generate_series(1,10) AS s(i);
 unfiltered | filtered
------------+----------
         10 |        4
</code></pre>

<p>So why <code>count(*)</code> and not <code>count()</code>? Because <code>count</code> is an aggregate
function I guess, and that&#8217;s one why to distinguish it from something,
say, <code>version()</code>.</p>

<h2>Type casts</h2>

<pre><code>CAST ( expression AS type )
</code></pre>

<p>is the same as</p>

<pre><code>expression::type
</code></pre>

<p>You can cast any string literal:</p>

<pre><code>select '4.123'::real;
 float4
--------
  4.123
(1 row)
</code></pre>

<p>Postgres implicitly casts things for you, e.g. assigning values to
columns (because the column type is obviously known). In some cases you
have to be explicit; Postgres works this way so as to not surprise you
with silent type casts.</p>

<h2>Collation</h2>

<p>http://stackoverflow.com/questions/4538732/what-does-collation-mean</p>

<p>It means how words/letters/phonemes are stored.</p>

<h2>Arrays</h2>

<p>must be rectangular</p>

<pre><code>SELECT ARRAY[ARRAY[1],ARRAY[1,2]];
ERROR:  multidimensional arrays must have array expressions with matching dimensions
</code></pre>

<h2>Composites</h2>

<pre><code>CREATE TYPE myrowtype AS (f1 int, f2 text);
SELECT ('1',2)::myrowtype;
</code></pre>

<h2>Order of expression evaluation</h2>

<p>Left-to-right short-circuit eval is not a thing:</p>

<pre><code>SELECT true OR somefunc();
</code></pre>

<p>Hence the above <em>probably</em> won&#8217;t run <code>somefunc</code>, but not because it&#8217;s on
the right and the left side evals to true, but because the evaluator&#8217;s
already gone thrugh and decided that it can do less work by only using
the left side.</p>

<p>CASE constructs defeat optimizations by forcing evaluation, so you could
write the above as</p>

<pre><code>SELECT CASE WHEN true THEN true ELSE somefunc() END;
</code></pre>

<p>or</p>

<pre><code>SELECT CASE WHEN true THEN true ELSE false END;
</code></pre>

<p>That&#8217;s pretty awesome. Declarative all the way. Let the evaluator figure
out the best way to go.</p>

<p>One gotcha is though is that the evaluator might try and simplify
constant subexpressions (subexpressions that don&#8217;t depend on any rows
being looked up), so something like this:</p>

<pre><code>SELECT CASE WHEN num &gt; 0 THEN num ELSE 1/0 END FROM nums;
ERROR:  division by zero
</code></pre>

<p>This happens because <code>num</code> is dynamic and the evaluator will evaluate
the <code>1/0</code> before even running the query, causing the divide by zero
error.</p>

<h2>Foreign keys</h2>

<blockquote><p>A foreign key must reference columns that either are a primary key or form a unique constraint. This means that the referenced columns always have an index (the one underlying the primary key or unique constraint); so checks on whether a referencing row has a match will be efficient.</p></blockquote>

<p>Makes sense:</p>

<pre><code>CREATE TABLE lols ( thing_id integer REFERENCES nums(num) );
ERROR:  there is no unique constraint matching given keys for referenced table "nums"
</code></pre>

<blockquote><p>Since a DELETE of a row from the referenced table or an UPDATE of a referenced column will require a scan of the referencing table for rows matching the old value, it is often a good idea to index the referencing columns too.</p>

<p>Because this is not always needed, and there are many choices available on how to index, declaration of a foreign key constraint does not automatically create an index on the referencing columns.</p></blockquote>

<p>So if an article has many comments, then <code>comments.article_id</code> is an FK,
hence <code>article.id</code> must have unique constraint. But if the referenced
article is deleted, then postgres needs to scan the <code>comments</code> table for
all rows referencing the deleted article to perform some logic on it. So
you probably want to index <code>comments.article_id</code>. That said you probably
want to index it anyway since you&#8217;ll be doing many comment lookups for a
given article.</p>

<h2>Postgres wiki</h2>

<p>https://wiki.postgresql.org/wiki/Main_Page</p>

<p>This seems surprisingly badass.</p>

<h2>Schemas / clusters</h2>

<p>The only data shared b/w databases is users and groups.</p>

<p>But schemas aren&#8217;t kept so separate; a database can have multiple
schemas, multiple schemas can have tables w the same name.</p>

<h2>Table Expressions</h2>

<p>Think of WHERE, GROUP BY, HAVING and others as modifiers that ultimately
produce a table that you can select from. Holy shit that would have made
my life so much easier if I knew that.</p>

<h2>Joins</h2>

<pre><code>FROM T1 CROSS JOIN T2isequivalenttoFROM T1 INNER JOIN T2 ON TRUE
</code></pre>

<p>Note that <code>WHERE</code> filtering happens after <code>ON</code> criteria. Again this is a
case of JOIN just being a thing that produces another virtual table and
WHERE filters whatever table.</p>

<h2>Subqueries</h2>

<p>Use them when you can&#8217;t use joins:</p>

<ul>
<li>subquery is a grouping / aggregation</li>
</ul>


<p>VALUES can also be a subquery.</p>

<h1>Sedition</h1>

<p>conduct or speech inciting rebellion against an authority or monarch</p>

<h1>Discount brokerage</h1>

<p>https://en.wikipedia.org/wiki/Discount_brokerage</p>

<p>Much cheaper than traditional brokerage but doesn&#8217;t offer financial
advice.</p>

<h1>Open-ended mutual funds</h1>

<p>Open-ended in that if you buy into a mutual fund, the shares granted to
you are created out of thin air, and the price of the share is based on
the total market value divided by the number of shares present.</p>

<h1>Intestacy</h1>

<p>State of having died but not written a will. Intestacy law deals with
divvying up inheritance for folks who didn&#8217;t write wills.</p>

<h1>Estate tax</h1>

<p>Only the largest 0.2% estates in US pay estate tax since it&#8217;s exempt up
to $5.5 million.</p>

<h1>Traditional IRA</h1>

<ul>
<li>put in money tax free when you&#8217;re in a high tax bracket</li>
<li>withdraw money taxed at a (presumably) lower tax bracket when you&#8217;re older</li>
</ul>


<h1>Forvo.com</h1>

<p>Pronunciation dictionary; let&#8217;s people upload recordings of
pronunciation into a map so that you can see how different regions
pronounce things.</p>

<h1>Inner Join conditions via WHERE/JOIN</h1>

<p>Already know you can do</p>

<pre><code>SELECT a,b WHERE a.wat = b.foo AND a.bleh &gt; 5;
</code></pre>

<p>But you can also move the join conditions to the JOIN &#8230; ON:</p>

<pre><code>SELECT a INNER JOIN b ON (a.wat = b.foo) WHERE a.bleh &gt; 5;
</code></pre>

<p>These are equivalent, whichever you choose is a matter of style.</p>

<p>Note that it only applies to INNER joins: the WHERE version of the above
only produces INNER joins; if you want outer, use the OUTER JOIN ON
syntax.</p>

<blockquote><p>The ON or USING clause of an outer join is not equivalent to a WHERE condition, because it results in the addition of rows (for unmatched input rows) as well as the removal of rows in the final result.</p></blockquote>

<p>Whereas INNER joins are reduced unions of both tables, and hence
expressable as WHERE, which is used for filtering out rows. In other
words, you can&#8217;t <em>add</em> rows to a result set with WHERE; WHERE is only
used for filtering, and OUTER joins can add rows to the result set.</p>

<h1>The WHERE clause</h1>

<p>Typically references at least one column referenced in table generated
in the FROM clause.</p>

<h1>GROUP BY</h1>

<blockquote><p>Grouping without aggregate expressions effectively calculates the set of distinct values in a col- umn. This can also be achieved using the DISTINCT clause (see Section 7.3.3).</p></blockquote>

<p>Makes sense.</p>

<p>We can actually verify that the postgres evaluator reduces this to the
exact same query plan:</p>

<pre><code>diff &lt;(psql -c "EXPLAIN SELECT DISTINCT name FROM foos") \
     &lt;(psql -c "EXPLAIN SELECT * FROM foos GROUP BY name")
</code></pre>

<h1>Objects instead of .publish().connect()</h1>

<pre><code>Ember.Object.extend({
  firstName: "alex",
  lastName:  "matchneer",

  // using lazy computed properties
  fullName: computed('firstName', 'lastName', function() {
    return `${this.get('firstName') ${this.get('lastName')}`;
  }),

  // using lazy computed properties
  fullName: computed(function() {
    return zip('firstName', 'lastName', (first, last) =&gt; `${first} ${last}`);
  }).live(),

  time: service(),
  completedInWords: computed('completedAt', 'time.sharedTicker', function(completedAt) {
    // hmm this doesn't need to be live
    return moment(this.get('completedAt')).agoInWords();
  }),

  liveTimer: liveComputed(function() {
    return this.ref('firstName').flatMapLatest((firstName) =&gt; {
      return Observable.interval(500);
    });
  }),

  startWeighing() {
    this.set('isWeighing', true);
  },

  isWeighing: false,
  rawWeights: computed('isWeighing', function() {
    if (this.get('isWeighing')) {
      return interval(200).map(() =&gt; Math.random());
    } else{
      return null; // or empty observable
    }
  }),

  // by subscribing to 'this', we're subscribing to lifetime of object.
  // so we're guaranteed that this gets evaluated immediately upon creation.
  // We want this behavior here
  isStillReceivingData: computed('this', function() {
    return this.ref('rawWeights').flatMapLatest(() =&gt; {
      return timer(500).map(_ =&gt; false).startWith(true);
    });
  }),

  doStuff: computed(function() {
  }).subscribe(), // this means is live for lifetime of object
                  // you know what else is live during lifetime of object?
                  // action handlers...

  doStuff: subscribe('actions.startDoingStuff', function() {
    alert("wat");
  }),
});


let Timer = Ember.Object.extend({
  hasElapsed: false,
  ms: 0,
  init() {
    this._super();
    this.timerId = Ember.later(() =&gt; {

    }, 500);
  }
});

Ember.Object.extend({
  hasReceivedDataTimer: computed('foo', function() {
    return Timer.create({ ms: 100 });
  }),
  hasReceivedDataRecently: alias('hasReceivedDataTimer.hasElapsed'),
});
</code></pre>

<h2>Maybe about to push the envelope</h2>

<p>https://en.wikipedia.org/wiki/Semantic_satiation</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-08-30T13:32:00-04:00" pubdate data-updated="true">Aug 30<span>th</span>, 2015</time></div>
	


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/08/26/help-me-with-observables/">
		
			Help Me With Observables</a>
	</h2>
	<div class="entry-content">
		<h2>How do I do this with Observables (or CSP or alternatives)</h2>

<p>I build/maintain <a href="http://www.expresscheckoutapp.com">Express Checkout</a>,
a hybrid app, which means it&#8217;s an Ember.js app running in an embedded
browser within an iOS/Android app that occasionally calls into the native app layer
to do native-specific things like turn on the camera, scan barcodes, register
for push notifications, etc.</p>

<p>I&#8217;ve been fascinated with <a href="https://github.com/Reactive-Extensions/RxJS/blob/master/doc/api/core/observable.md">Rx Observables</a>
for some time now and have used them to clean up a lot of the code in my
app that deals with asynchronous behavior and concurrency. But there&#8217;s
one part of my app I&#8217;ve been avoided refactoring with Observables
because I just can&#8217;t wrap my head around how to approach it and express
it with Observables, hence I&#8217;m enlisting any functionally-minded
Observables veterans to help me think about how to structure this.</p>


		
		<a href="/blog/2015/08/26/help-me-with-observables/" class="more-link">Read on &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-08-26T14:11:00-04:00" pubdate data-updated="true">Aug 26<span>th</span>, 2015</time></div>
	


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/07/29/ewouldblockagain/">
		
			Ewouldblockagain</a>
	</h2>
	<div class="entry-content">
		<h2>EAGAIN</h2>

<p>If you try a non-blocking read and there&#8217;s no data available for you,
then EAGAIN fires.</p>

<p>https://github.com/redis/redis-rb/blob/master/lib/redis/connection/ruby.rb#L47-L62</p>

<pre><code>def _read_from_socket(nbytes)
  begin
    read_nonblock(nbytes)

  rescue Errno::EWOULDBLOCK, Errno::EAGAIN
    if IO.select([self], nil, nil, @timeout)
      retry
    else
      raise Redis::TimeoutError
    end
  end

rescue EOFError
  raise Errno::ECONNRESET
end
</code></pre>

<p>So:</p>

<ol>
<li>Try and read in a non-blocking manner</li>
<li>If no data is available the read, IO.select to block for <code>@timeout</code>
seconds until there&#8217;s something to read. If there&#8217;s nothing to read
after <code>@timeout</code> seconds, it returns nil and raises a redis error.</li>
<li>If there is something to read, start over and try a non-reading
block again, which should succeed.</li>
</ol>


<p>If it throws TimeoutError then the redis call took longer than the
default 5 seconds, probably cuz the server&#8217;s overwhelmed.</p>

<p>So, why even bother <code>read_nonblock</code> at first if you&#8217;re just going to
block on IO.select? Why not just do a blocking read with a timeout? I&#8217;m
guessing because it doesn&#8217;t exist since it can otherwise be expressed
with the above structure of 1) try nonblocking read and 2) block with
IO.select and retry again. This answer is probably wrong but jesus
christ this stuff is nuts.</p>

<h2>XCode Build Settings</h2>

<p>BOLD means motherfuckin STRING LITERAL as opposed to</p>

<h2>Apple iOS plist format</h2>

<p>https://gist.github.com/palaniraja/1051160</p>

<p>Then you need a link like</p>

<pre><code>&lt;a href="itms-services://?action=download-manifest&amp;url=itms-services://?action=download-manifest&amp;url=http:/oursite.com/myApp.plist" id="text"&gt;
</code></pre>

<p>http://stackoverflow.com/questions/8439127/ios-enterprise-distribution-through-ota</p>

<p>https://longtrieuquang.wordpress.com/2014/08/01/how-to-distribute-your-ios-app-ota-with-enterprise-account/</p>

<h2>Plot Armor</h2>

<p>http://tvtropes.org/pmwiki/pmwiki.php/Main/PlotArmor</p>

<p>When you&#8217;re so essential to the story that obviously you won&#8217;t be killed
by some fight or some bullet, you have plot armor. Because you&#8217;re
crucial to the plot.</p>

<h2>Point ember components to github zipped archives</h2>

<p>e.g. instead of</p>

<pre><code>"ember": "components/ember#fed005fdc4dc3a8f19324a887c1021e8bf19acf4",
</code></pre>

<p>do</p>

<pre><code>"ember": "https://github.com/components/ember/archive/ae3730263f416204e424f884c8444190e5a967dc.zip",
</code></pre>

<p>The former will clone the massively large repo of compiled Ember builds,
which takes forever even with an insanely fast connection, while the
latter just downloads a zip of a snapshot of the directory tree at that
particular checkout, which is FAST.</p>

<h2>Time Zones</h2>

<p>Basically this railscast is amazing.</p>

<p>http://railscasts.com/episodes/106-time-zones-revised</p>

<p>Ruby <code>Time.now</code> uses system timezone. Verifiable by opening <code>irb</code> and
running <code>Time.now</code> many times whilst changing the timezone in system
preferences.</p>

<p>Use <code>around_filter</code> with <code>Time.use_zone(current_user.time_zone, &amp;block)</code></p>

<h2>Less mixins vs extend</h2>

<p>http://lesscss.org/features/#extend-feature-use-cases-for-extend</p>

<p>Mixins copy and paste CSS rules into everyone who mixes it in. Extend
just creates multiple selections for the same rules, which almost
certainly means smaller output CSS size (but perhaps adds to CSS engine
overhead since there are more rules to check against?).</p>

<h2>objects vs memoizations</h2>

<p>Say you have an array of people:</p>

<pre><code>people = [
  {
    id: 1,
    first_name: "Alex",
    last_name:  "Matchneer",
    follows: [
      312,
      { somePersonObjOfSameRecursiveStructure },
      999
    ]
  },
  {
    id: 2,
    first_name: "Noel",
    last_name:  "Gallagher",
    follows: [
      1,
      { somePersonObjOfSameRecursiveStructure }
    ]
  },
]
</code></pre>

<p>What&#8217;s the difference between</p>

<pre><code>people[0]
</code></pre>

<p>and</p>

<pre><code>get(people, 0)
</code></pre>

<p>? What&#8217;s the difference between</p>

<pre><code>people[0].first_name
</code></pre>

<p>and</p>

<pre><code>get(get(people, 0), 'first_name')
</code></pre>

<p>? What&#8217;s the difference between</p>

<pre><code>person # a var with mem address 0x00001234
</code></pre>

<p>and</p>

<pre><code>get(MEMORY, 0x00001234)
</code></pre>

<p>?</p>

<p>It&#8217;s all just memoization. In the end, every object has a memory
address. Variables are just memoized <code>get(MEMORY, someMemoryAddress)</code>.</p>

<p><code>===</code> in javascript is just memory address comparisons.</p>

<p>What if you needed to print a credits page, and the same person had
multiple roles, e.g. director, producer, actor, and you wanted to print
out a formal version of their first and last name. Maybe you&#8217;d write a
function:</p>

<pre><code>function formalizedName(person) {
  return `M. ${person.first_name} ${person.last_name}`;
}
</code></pre>

<p>But if you&#8217;re rendering a page and that name shows up multiple times,
you&#8217;re wastefully recomputing, concatenating. Let&#8217;s assume avoiding
recomputation/concatenation would improve performance by some noticeable
margin. You could memoize, i.e. store the result</p>

<p>blah blah blah</p>

<h2>binding and immutability</h2>

<pre><code>  Hello . Your friends are:
</code></pre>

<p>if <code>people</code> is an immutable data structure, then any of the following
modifications will produce a new immutable value of <code>people</code>:</p>

<ul>
<li>a person&#8217;s name changes</li>
<li>a person&#8217;s list of friends changes</li>
<li>a person&#8217;s friend&#8217;s name changes</li>
<li>etc</li>
</ul>


<p>But we&#8217;re using &#8220;, which means we&#8217;re creating bindings (internally
we&#8217;re creating keystreams, and those create bindings according to the
ember object model). This means we&#8217;ll be creating meta objects on each
immutable data pojo&#8230; which is wasteful and useless considering they&#8217;re
immutable, and their properties can&#8217;t can&#8217;t change.</p>

<p>So why not use <code>unbound</code> helper within each curly? It&#8217;d save us an
observer, right? It&#8217;d save us writing to <code>meta</code>, right? Sure, but it
also means that it won&#8217;t update the second time around, because it&#8217;s
unbound.</p>

<p>So basically, &#8220; does two things:</p>

<p>1) Sets up a keystream
2) Sets up a binding</p>

<p>TL;DR to get immutable structures bindable in a performant manner in
Ember, we need to make it possible to opt into a different KeyStream
constructor:</p>

<ol>
<li>it doesn&#8217;t call add/removeObserver (wasteful since it&#8217;ll never fire)</li>
<li>don&#8217;t assume that just because <code>changed, that</code>
changed; with immutable data, it&#8217;s pretty likely a.prop is actually
the same assuming that&#8217;s not one of the properties that was changed
between the old immutable value and the new immutable value.</li>
</ol>


<h2>Lazy Observables / Ember Streams</h2>

<p>Unlike push-only observables, Ember streams are push/pull. You push
that something has changed by <code>notify()</code>, and then later on you pull
with <code>value()</code>, which only runs through computations once.</p>

<p>This implies laziness. In Ember, the laziness of an LO lasts from the
first <code>.set</code> that changes a watched value until the <code>render</code> run loop
queue.</p>

<p>For similar reasons, this is why computed properties don&#8217;t work with
observers without an explicit get to eagerly flush a CP.</p>

<p>But anyway, what are the tradeoffs between LO and push-only Observables?</p>

<p>Well, one is that, if you funnel an O into an LO, then
you&#8217;re discarding a bunch of onNexts until some arbitary pull into
the future (yet you only end up reading the most recent &#8220;event&#8221;).</p>

<p>Here&#8217;s a stab at lazy observables:
http://jsbin.com/polude/6/edit?html,js,console,output</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-07-29T16:53:00-04:00" pubdate data-updated="true">Jul 29<span>th</span>, 2015</time></div>
	


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/07/21/sriracha/">
		
			Sriracha</a>
	</h2>
	<div class="entry-content">
		<h2>Android GUI Architecture</h2>

<p>Single-threaded, event-driven, nestable components, much like:</p>

<ul>
<li>AWT

<ul>
<li>Java&#8217;s original cross-platform UI widget toolkit</li>
</ul>
</li>
<li>Swing

<ul>
<li>richer widget set</li>
<li>draws its own widgets rather than using host OS&#8217;s user interface widgets</li>
</ul>
</li>
<li>SWT

<ul>
<li>alternative to AWT/Swing, heavy use/development by Eclipse</li>
</ul>
</li>
<li>LWUIT (Lightweight User Interface Toolkit)

<ul>
<li>for Java ME (micro edition, mobile phones, etc)</li>
</ul>
</li>
<li>others</li>
</ul>


<p>So what UI library / environment doesn&#8217;t have a single UI thread? It
doesn&#8217;t seem like there is one. UI data-structures are so fragile and
coupled that you&#8217;d need to mutex the hell out of them any way; easier to
just have a single UI thread.</p>

<p>http://stackoverflow.com/a/1677785</p>

<h2>Android Event Loop</h2>

<ol>
<li>User touches the screen</li>
<li>Android system enqueues action on event queue</li>
<li>UI thread dequeues event, dispatches to handler</li>
<li>Tell the Model that state has changed</li>
<li>Model notifies UI framework that some portion of display is stale
(which is just another action enqueued to the same event queue)</li>
<li>redraw event removed from queue, dispatched to a View, tree of views
is redrawn</li>
</ol>


<p>Specific example:</p>

<ol>
<li>User taps screen, framework enqueues MotionEvent</li>
<li>MotionEvent is dequeued, framework dispatches to the first view
within the bounding box of where tap happened</li>
<li>Button handler tells model to resume playing a song</li>
<li>Model starts playing song, enqueues redraw request</li>
<li>redraw request dequeued, redraw occurs</li>
</ol>


<p>A Button therefore acts like both a Controller and a View; it handles
tap events and updates a model, and then gets redrawn accordingly to
reflect updated state.</p>

<p>Never update display within a controller handler; just issue redraw
requests. Aside from separating concerns, this lets multiple redraw
events essentially coalesce into one, after ALL changes caused by the
handler have been made.</p>

<p>Single-threaded-ness means:</p>

<ul>
<li>no synchronize blocks b/w View and Controller; just enqueue and the
single threaded UI looper will pop. QUESTION: do you need to
synchronize pushing to the queue? What if multiple threads are pushing
to the queue? ANSWER: the queue is managed by the Hander class, which
is bound to a specific Looper and thread. You <code>post</code> to the Handler,
and Handler <code>post</code> methods are threadsafe.</li>
<li>it&#8217;s easy to completely block/stall your application if you&#8217;re doing
something long/slow/expensive; move that logic to some other thread</li>
</ul>


<h2>What&#8217;s a widget?</h2>

<p>Leaves in the view tree, basically.</p>

<h2>Tunneling to Redis from the browser</h2>

<p>Was reading a Heroku thing about not abusing tunnels via websockets, so
I figured I&#8217;d connect to Redis from the browser because why not.</p>

<p>First off</p>

<pre><code>npm install -g wstunnel
</code></pre>

<p>Then in somefile.html</p>

<pre><code>&lt;input type="text" id="textInput"/&gt;

&lt;pre id="messages"&gt;&lt;/pre&gt;

&lt;script type="text/javascript" charset="utf-8"&gt;
  var redisSocket = new WebSocket("ws://localhost:8080", ["tunnel-protocol"]);

  redisSocket.onmessage = function(event) {
    // need FileReader to convert from blob to text
    var reader = new window.FileReader();
    reader.readAsText(event.data);
    reader.onloadend = function() {
      messages.innerHTML += reader.result;
    }
  };

  textInput.addEventListener('keypress', function(e) {
    if (e.keyCode !== 13) { return; }
    redisSocket.send(new Blob([textInput.value + "\n"]));
    textInput.value = "";
  }, false);
&lt;/script&gt;
</code></pre>

<p>Then you can type in raw redis commands and get raw redis responses.
Pretty cool.</p>

<h2>ngrok</h2>

<p>Tunnel public URL to your localhost server. Useful for:</p>

<ul>
<li>testing webhooks</li>
<li>testing apps that don&#8217;t have access to localhost, etc</li>
</ul>


<h2>Localytics (and analytics terminology)</h2>

<p><a href="https://en.wikipedia.org/wiki/Attribution_(marketing">Attribution</a>)</p>

<p>The quantification of how a given ad impression influences a user
conversion rates. Use Attribution to find out which ad campaigns seem to
be the most effective. I guess you could also say use Attribution to
figure out which entry points into an app most often lead to conversion.</p>

<ul>
<li>sessionTimeoutSeconds

<ul>
<li>time after <code>close()</code> that the session is actually considered closed.</li>
<li>if <code>open</code> is called within the timeout&#8230; on the same localyticsRequest object.</li>
</ul>
</li>
</ul>


<h2>Google Analytics events</h2>

<p>https://support.google.com/analytics/answer/1033068#Anatomy</p>

<h3>Category</h3>

<p>Over-arching string name for a category of events.</p>

<ul>
<li>You need to decide ahead of time whether you care to distinguish
between &#8220;Videos - Cats&#8221; and &#8220;Videos - Dogs&#8221; or whether you just
want them grouped under &#8220;Videos&#8221;</li>
<li>You&#8217;re screwed if you push a version of your code sending a category
of &#8220;Video&#8221; and later change to &#8220;Videos&#8221;; your historical data will
remain there as &#8220;Video&#8221; (this is probably true for all Event fields)</li>
</ul>


<h3>Action</h3>

<p>The thing being done, the name of the event. If you&#8217;re category is
&#8220;Videos&#8221;, you might have actions named:</p>

<ul>
<li>Play</li>
<li>Stop</li>
<li>Pause</li>
</ul>


<p>Caveats:</p>

<ul>
<li>&#8220;All actions are listed independently from their parent categories&#8221;.
This means if you have re-use the event name &#8220;Play&#8221; between parent
categories &#8220;Videos&#8221; and &#8220;Songs&#8221;, they&#8217;ll all be munged together, and
it&#8217;s only when you do a breakdown of &#8220;Play&#8221; events that their differing
parent categories will show up. But you probably don&#8217;t want to have
something so general as a &#8220;click&#8221; event across a ton of different
categories.</li>
<li>&#8220;A unique event is determined by a unique action name&#8221;. Oh ok this
explains the above a bit &#8220;You can use duplicate event names across
categories&#8221;.</li>
</ul>


<h2>document.readyState and friends</h2>

<ul>
<li><code>DOMContentLoaded</code>

<ul>
<li>DOM and synchronous scripts (the default) have been loaded</li>
<li>does NOT wait for stylesheets, images, subframes, etc</li>
<li>scripts can be made async to not interfere w this loading process</li>
<li>UNSURE: can listen on <code>window</code> or <code>document</code></li>
</ul>
</li>
<li><code>load</code> event

<ul>
<li>all subresources (images, stylesheets, subframes) have loaded</li>
<li>only fires on <code>window</code></li>
</ul>
</li>
</ul>


<p>But you can also ask <code>document.readyState</code> where you are in the process:</p>

<p>https://developer.mozilla.org/en-US/docs/Web/API/Document/readyState</p>

<ul>
<li>loading

<ul>
<li>The document is still loading.</li>
</ul>
</li>
<li>interactive

<ul>
<li>The document has finished loading and the document has been parsed but sub-resources such as images, stylesheets and frames are still loading. The state indicates that the DOMContentLoaded event has been fired.</li>
</ul>
</li>
<li>complete

<ul>
<li>The document and all sub-resources have finished loading. The state indicates that the load event has been fired.</li>
</ul>
</li>
</ul>


<p>Add <code>document.readyState</code> to your watches and run:</p>

<pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;meta name="viewport" content="width=device-width"&gt;
    &lt;title&gt;DOMContentLoaded&lt;/title&gt;
  &lt;/head&gt;

  &lt;script type="text/javascript" charset="utf-8"&gt;

    debugger;

    window.addEventListener("load", function(e) {
      debugger;
      //alert("i am loaded");
    }, false);

    window.addEventListener("DOMContentLoaded", function(e) {
      debugger;
    }, false);

  &lt;/script&gt;
  &lt;body&gt;
    body
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>

<h2>window.onerror and CORS</h2>

<p>http://blog.errorception.com/2012/04/script-error-on-line-0.html</p>

<p>Script error on line 0.</p>

<p>This almost certainly means a script loaded via CORS fired an error.
Modern browsers zero-out the data</p>

<p>http://jeremiahgrossman.blogspot.in/2006/12/i-know-if-youre-logged-in-anywhere.html</p>

<p>The above 2006 link demonstrates how the errors produced by a non CORS
remote script can be used to sniff out which sites you&#8217;re logged into,
and hence modern browsers strip all information from external non CORS
scripts to just say line 0 and &#8220;Script Error.&#8221;. This thwarts bugsnag
unless the script you load is CORS.</p>

<h2>Ruby Exception#cause</h2>

<p>If one caught exception causes another to be raised, Ruby keeps track of
all preceding exceptions within a chain of Exception#cause. Bugsnag uses
this to great effect.</p>

<pre><code>begin
  begin
    raise "wat"
  rescue =&gt; e
    oasnoiasd
  end
rescue =&gt; e
  puts e.cause.backtrace # print the backtrace of RuntimeError "wat"
end
</code></pre>

<p>https://bugsnag.com/blog/ruby-2-1-exception-causes</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-07-21T20:28:00-04:00" pubdate data-updated="true">Jul 21<span>st</span>, 2015</time></div>
	


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/06/28/spf-10000/">
		
			SPF 10000</a>
	</h2>
	<div class="entry-content">
		<h2>SPF: Sender Policy Framework</h2>

<p>Prevents sender spoofing: server receiving STMP mail can check the
sender&#8217;s IP against SPF DNS records. SPF records are stored in
both SPF and TXT records and have a format like:</p>

<pre><code>"v=spf1 a mx ip4:55.11.65.20/2 ip4:90.2.123.112/2 ip4:176.33.87.19/2 ip4:212.63.89.33/2 -all"
</code></pre>

<p>Question: what if the sender sends the wrong IP? Answer: then the server
wouldn&#8217;t be able to communicate back to the sender (SMTP operates over
TCP, so you have the handshake and connection state preventing IP
spoofing).</p>

<p>Google apps for businesses makes you add an SPF record to your domain so
that it can send e-mail on your behalf and not have recipient servers
block it.</p>

<h2>SRV records: share the location of services via DNS</h2>

<p>https://tools.ietf.org/html/rfc2782</p>

<p>Sample:</p>

<pre><code>_sip._tcp.example.com. 86400 IN SRV 10 60 5060 bigbox.example.com.
</code></pre>

<p>Google apps for businesses also use this for XMPP service location. SRV
records have a priority in a weight. Clients must use the lowest
priority services, and then if there are multiple services in that
priority, randomly select using the provided <code>weight</code>s.</p>

<h2>Ember tests</h2>

<pre><code>import hbs from 'htmlbars-inline-precompile';
import { moduleForComponent, test } from 'ember-qunit';

moduleForComponent('my-component', {
  integration: true
});

test('block params work', function(assert) {
  this.render(hbs`

      This happened  days ago.

  `);

  this.set('theDate', new Date(2015, 2, 11));
  assert.equal(this.$().text().trim(), "This happened 123 days ago.");
});
</code></pre>

<p>In recent versions, <code>integration:true</code> is the default.</p>

<p>Checked in:</p>

<p>https://github.com/switchfly/ember-test-helpers/pull/38</p>

<p>Nice example:</p>

<p>https://github.com/yapplabs/ember-radio-button/blob/master/tests/unit/components/radio-button-test.js#L27-L56</p>

<p>Aaaaand a nice blag!</p>

<p>http://alisdair.mcdiarmid.org/2015/06/20/ember-component-integration-tests.html</p>

<h2>Vim: save and run</h2>

<p>From DAS: easy enough to just write a quick <code>map</code> on the fly:</p>

<pre><code>map ,t :w\|!ruby %&lt;cr&gt;
</code></pre>

<h2>JS Regex: multiline</h2>

<p>Use <code>/m</code> option and your <code>^</code> and <code>$</code> will match beginnings/ends of lines
rather than beginnings and ends of the entire string. :)</p>

<h2>Hyperthreading, Physical vs Logical Cores</h2>

<pre><code>machty.github.com :: sysctl hw.physicalcpu
hw.physicalcpu: 4
machty.github.com :: sysctl hw.logicalcpu
hw.logicalcpu: 8
</code></pre>

<p>Feature of Intel Core i5 and i7 (probably others too). Allows, in
certain cases, multiple executions to be run on a single core, squeezing
out more power out of a single core. Allows multiple threads to run on
the same core. Gives a 20% performance boost in a lot of cases (rather
than 100% boost of a full on new core).</p>

<h2>Ember boot</h2>

<p>https://github.com/emberjs/ember.js/pull/10256#issuecomment-113846021</p>

<ol>
<li>Ember loads.</li>
<li>You create an <code>Ember.Application</code> instance global (e.g. <code>App</code>).</li>
<li>At this point, none of your classes have been loaded yet.</li>
<li>As your JavaScript file is evaluated, you register classes on the application (e.g. <code>App.MyController = Ember.Controller.extend(…);</code>)</li>
<li>Ember waits for DOM ready to ensure that all of your JavaScript included via <code>&lt;script&gt;</code> tags has loaded.</li>
<li>Initializers are run.</li>
<li>If you need to lazily load code or wait for additional setup, you can call <code>deferReadiness()</code>.</li>
<li>Once everything is loaded, you can call <code>advanceReadiness()</code>.</li>
<li>At this point, we say that the <code>Application</code> is ready; in other words, we have told Ember that all of the classes (components, routes, controllers, etc.) that make up the app are loaded.</li>
<li>A new instance of the application is created, and instance initializers are run.</li>
<li>Routing starts and the UI is rendered to the screen.</li>
</ol>


<h2>Brew Terminology</h2>

<p>https://github.com/Homebrew/homebrew/blob/master/share/doc/homebrew/Formula-Cookbook.md#terminology&#8212;homebrew-speak</p>

<p>Formula The package definition  /usr/local/Library/Formula/foo.rb
Keg The installation prefix of a Formula    /usr/local/Cellar/foo/0.1
opt prefix  A symlink to the active version of a keg    /usr/local/opt/foo
Cellar  All kegs are installed here /usr/local/Cellar
Tap An optional repository (git) of Formulae    /usr/local/Library/Taps
Bottle  Pre-built (binary) Keg that can be unpacked qt-4.8.4.mountain_lion.bottle.1.tar.gz</p>

<h2>Slack: Shift Escape</h2>

<ul>
<li>shift-esc marks all channels as read</li>
</ul>


<h2>Ember fix force push?</h2>

<p>Here&#8217;s a git fetch</p>

<pre><code>From github.com:emberjs/ember.js
 + 61c9ba6...c3f15cf master     -&gt; origin/master  (forced update)
   4aab5ad..d1a1a7c  beta       -&gt; origin/beta
 + 5a084f7...e7866ca in-template-config -&gt; origin/in-template-config  (forced update)
 + 172002f...642f5c3 remove-bind-attr -&gt; origin/remove-bind-attr  (forced update)
   c3accfb..1ad89cf  stable     -&gt; origin/stable
</code></pre>

<h2>vim-rails and other shit i should already know</h2>

<p>Come on this has been out forever how do you not know this.</p>

<ul>
<li>ctrl-O back</li>
<li>ctrl-I forward</li>
<li>gf: go to file of hovered-over class</li>
</ul>


<h2>Justdelete.me</h2>

<p>http://justdelete.me/</p>

<p>Instructions for how to remove yourself from various services, social
media, etc.</p>

<h2>Java <code>final</code> and immutable objects</h2>

<p>Since Java strings are immutable, the String class must be declared
<code>final</code>. Otherwise, someone could just subclass <code>String</code> and mutate it,
breaking the immutable guarantees of the parent String class.</p>

<h2>Java <code>@Override</code> annotation</h2>

<p>Not strictly required, but hints to the compiler what you&#8217;re trying to
do, and errors out if you fail to correctly override a parent class&#8217;s
method.</p>

<h2>Java: Checked vs Unchecked Exceptions</h2>

<p>Checked: required in <code>throws</code> clause.</p>

<p>Unchecked: not required in <code>throws</code> clause, must extend <code>RuntimeException</code>.</p>

<p>This might be wrong but checked exceptions kinda just feel like they&#8217;re
just part of the type signature, e.g. &#8220;this is a method that returns a
<code>Result</code>, <code>IOException</code>, <code>ParseException</code>, or <code>SomeOtherThing</code>&#8221;. In
functional land it seems like it&#8217;d be really easy to switch based on the
result.</p>

<h2>Android: Dalvik</h2>

<p><a href="https://en.wikipedia.org/wiki/Dalvik_%28software%29">wiki</a></p>

<p>Android compiles your java down to JVM bytecode <code>.class</code> files, and then
the dexer compiles <code>.class</code> files down to Dalvik bytecode. Androids
don&#8217;t have JVMs. They have DVMs. Actually, they did until about Android
4.4. Now they&#8217;re replaced by <a href="https://en.wikipedia.org/wiki/Android_Runtime">Android Runtime</a>.</p>

<h2>Android Activity</h2>

<p>Activity is UI + execution. It&#8217;s a component, I guess.</p>

<p>Activities invoke each other with Intents. Several activities might be
registered for a given Intent. An application is a bundle of activities.
Activities don&#8217;t directly call code on other activities; rather, intents
are used. Don&#8217;t hold on to references to Activities; they&#8217;re meant to be
aggressively GC&#8217;d.</p>

<p>A Task is a chain of user interactions that might span multiple
activities (sometimes apps), e.g. going to Messaging, looking up a
Contact, and calling that contact (3 separate activities from 3
different apps).</p>

<p>A Service is a background task, e.g. music player, or any kind of server
waiting for a client interaction. Android avoids reclaiming services and
keeps them alive unless extreme memory pressure.</p>

<h2>Android multi-user</h2>

<p>Android runs on Linux, and each application vendor gets its own user and
group, and all applications installed are run under that user and group.
So basically applications can&#8217;t access other applications&#8217; data, unless
they&#8217;re from the same application vendor (as determined by the keystore
that signed the release apk?).</p>

<h2>String#%</h2>

<p>http://ruby-doc.org/core-2.2.2/String.html#method-i-25</p>

<pre><code>"foo = %{foo}" % { :foo =&gt; 'bar' }        #=&gt; "foo = bar"
</code></pre>

<h2>Base64 from the shell</h2>

<pre><code>echo "wat" | openssl enc -base64 -A
d2F0Cg==
</code></pre>

<p>From http://www.w3.org/TR/SRI/#goals</p>

<pre><code>echo -n "alert('Hello, world.');" | openssl dgst -sha256 -binary | openssl enc -base64 -A
</code></pre>

<h2>SubscribeOn vs ObserveOn</h2>

<p>http://blogs.msdn.com/b/rxteam/archive/2009/11/21/observable-context-observable-subscribeon-and-observable-observeon.aspx</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-06-28T17:06:00-04:00" pubdate data-updated="true">Jun 28<span>th</span>, 2015</time></div>
	


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/06/11/anermic/">
		
			Anermic</a>
	</h2>
	<div class="entry-content">
		<h2>Nils nils nils</h2>

<p>Yes, use <code>.fetch()</code> over <code>[]</code> if you&#8217;re working with an options hash
where all fields are expected/required so that you don&#8217;t accidentally
leak nils. But <code>.fetch(:wat, nil)</code> is the
most pointless thing of all time. It adds no value over <code>[:wat]</code>. So
stop thinking about it, Matchnozzle!</p>

<h2>JSON Pointer</h2>

<p>RFC: https://tools.ietf.org/html/rfc6901</p>

<p>TL;DR defines how to reference values within a JSON doc in a
standardized way, including via normal URIs. So potentially you could
cite a value in an API request from Wikipedia I guess.</p>

<p>Also used in JSON Patch to describe the path to changed things.</p>

<h2>Persistent Data Structure</h2>

<p>https://en.wikipedia.org/wiki/Persistent_data_structure</p>

<p>Preserves a previous version of itself when modified; often intertwined
with &#8220;immutable&#8221; since in some languages/libraries like Clojure data
structures internally share structure with others between operations.</p>

<h2>Racket</h2>

<p>Lispy language that compiles down to bytecode run on a proprietary
runtime.</p>

<p>Excellent article: http://programming-puzzler.blogspot.com/2010/08/racket-vs-clojure.html</p>

<p>In short, Clojure wins because of data structures (but is still
annoyingly limited by Java ties; no tail recursion, poor performance w
numbers sometimes, etc).</p>

<h2>Bottom line</h2>

<p>Literally the bottom line of a statement, where the total is calculated.
That&#8217;s what the saying&#8217;s referring to when folk say how&#8217;s this affect
our bottom line.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-06-11T11:39:00-04:00" pubdate data-updated="true">Jun 11<span>th</span>, 2015</time></div>
	


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/05/25/brooch/">
		
			Brooch</a>
	</h2>
	<div class="entry-content">
		<h2>Brooch</h2>

<p>wtf is a brooch.</p>

<p>http://en.wikipedia.org/wiki/Brooch</p>

<p>Decorative jewelry that can be attached to garments, often to hold them
closed. Could be collars to shirt, could be holding together a robe-ish
thing. Brooch brooch brooch. Remember that shit.</p>

<h2>Android HW Accel</h2>

<p>There&#8217;s hardware acceleration in the Android rendering pipeline since
Honeycomb, Android 3.0, which came out Feb 2011. By default,
the manifest attr that controls this is set to false:</p>

<pre><code>&lt;application ... android:hardwareAccelerated="false"&gt;
</code></pre>

<p>So you&#8217;d have to set that to true to enable hw accel globally. Then
there&#8217;s finer granularity for <code>window</code> and <code>View</code> via setFlags and
setLayerType.</p>

<h2>Amazon Local</h2>

<p>What it is? Google autocomplete search elucidates:</p>

<p>&#8220;amazon local vs&#8221;</p>

<ul>
<li>groupon</li>
<li>livingsocial</li>
<li>square</li>
</ul>


<p>Seems to promote your business via groupon-esque deals.</p>

<h2>Java Anonymous Classes</h2>

<p>Weird syntax I didn&#8217;t recognize. Basically lets you instantiate an
anonymous class assuming you don&#8217;t need to share the class. The cool
thing about this is that you can implement/instantiate an instance of a
class based entirely on an Interface (this was weird for me since
Interfaces in Java seem like these ephemeral ghostly non-existent things
that normally take a lot of verbose code to instantiate).</p>

<p>https://docs.oracle.com/javase/tutorial/java/javaOO/anonymousclasses.html</p>

<pre><code>public class HelloWorldAnonymousClasses {

    interface HelloWorld {
        public void greet();
        public void greetSomeone(String someone);
    }

    public void sayHello() {
        // this a function body!

        // this is a "local" class... which means you define it,
        // and...
        class EnglishGreeting implements HelloWorld {
            String name = "world";
            public void greet() {
                greetSomeone("world");
            }
            public void greetSomeone(String someone) {
                name = someone;
                System.out.println("Hello " + name);
            }
        }

        // ... THEN you instantiate it
        HelloWorld englishGreeting = new EnglishGreeting();

        // This is an anonymous class; define it at the same time
        // you instantiate it.
        HelloWorld frenchGreeting = new HelloWorld() {
            String name = "tout le monde";
            public void greet() {
                greetSomeone("tout le monde");
            }
            public void greetSomeone(String someone) {
                name = someone;
                System.out.println("Salut " + name);
            }
        };
</code></pre>

<h2>Wadsworth Constant</h2>

<p>http://www.urbandictionary.com/define.php?term=Wadsworth+Constant</p>

<blockquote><p>The Wadsworth Constant is the fundamental idea that the true meaning of a video, conversation, or comment approaches importance after approximately 30% of it has been skipped over.</p></blockquote>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-05-25T01:51:00-04:00" pubdate data-updated="true">May 25<span>th</span>, 2015</time></div>
	


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/05/11/cransible/">
		
			Cransible</a>
	</h2>
	<div class="entry-content">
		<h2>ControlPersist</h2>

<p>A feature of SSH that multiplexes ssh sessions over one TCP connection,
cuts down TCP connection overhead, etc. Ansible benefits from it.</p>

<h2>Host-based authentication</h2>

<p>hence <code>pg_hba.conf</code>.</p>

<h2>binstubs and gem</h2>

<p>here&#8217;s a binstub</p>

<pre><code>require 'rubygems'
gem 'bundler'
load Gem.bin_path('bundler', 'bundle')
</code></pre>

<p>binstubs prep <code>$LOAD_PATH</code> (<code>$:</code> is the same thing) before a gem is run.</p>

<p>The <code>gem 'bundler'</code> command prepends <code>LOAD_PATH</code> with the specified
gem&#8217;s load paths. Additional calls to gem append after the load paths of
earlier gems.</p>

<h2>fail2ban</h2>

<p>scans your logfiles, looks for malicious activity, bans bad guys for a
while.</p>

<h2>Digital Ocean droplets have public IPs, ec2s are priv</h2>

<p>ec2 <em>does</em> expose public url but it has to go through a firewall defined
by your security group. Note that this is obvious because, within an ec2
instance, its IP is in one of the private IP address ranges
(10.something, 192.168.something, and i think 172.something).
So <em>can</em> you use a private IP publicly?</p>

<p>http://serverfault.com/questions/57155/can-an-ip-address-in-the-private-range-be-used-as-a-public-address</p>

<p>You <em>could</em>, but any network admin/ISP is going to block egress and
ingress packets sourced/destined for any of these ranges. This prevents
IP spoofing among other things, e.g. you can&#8217;t forge a fake packet and
expect it to be routed to some internal server, which might read and
respond to the packet and cause damage&#8230; all of this is avoided by
internal servers using private IPs.</p>

<h2>Ansible: modules vs playbooks vs rules</h2>

<ul>
<li>playbook

<ul>
<li>list of &#8220;plays&#8221;</li>
</ul>
</li>
<li>play

<ul>
<li>map a group of hosts to some well-defined roles</li>
</ul>
</li>
<li><h2>roles</h2></li>
<li>tasks

<ul>
<li>call to an ansible module (which can directly be done via something
like <code>ansible somehost -m ping</code></li>
<li>tasks are performed one at a time (though they probably branch out
simultaneously on multiple hosts)</li>
</ul>
</li>
<li>module

<ul>
<li>can be executed directly via <code>ansible</code> or via playbooks</li>
<li>a specific command, can make changes to a variety of server types</li>
<li>e.g.

<ul>
<li>ansible webservers -m service -a &#8220;name=httpd state=started&#8221;</li>
<li>ansible webservers -m ping</li>
<li>ansible webservers -m command -a &#8220;/sbin/reboot -t now&#8221;</li>
</ul>
</li>
</ul>
</li>
</ul>


<h2>Ansible tags</h2>

<p>http://docs.ansible.com/playbooks_tags.html</p>

<p>Use tags to run subsets of a playbook.</p>

<ul>
<li>tag certain tasks</li>
<li>specify at run time a tag of which tasks to run</li>
<li>you can also tag includes

<ul>
<li>such that if you specify tags to ansible-playbook, it won&#8217;t include
those rules unless tagged</li>
</ul>
</li>
</ul>


<h2>Sudo password is yours, not roots!!!!</h2>

<p>http://www.howtogeek.com/111479/htg-explains-whats-the-difference-between-sudo-su/</p>

<blockquote><p>When you execute sudo command, the system prompts you for your current user account’s password before running command as the root user. By default, Ubuntu remembers the password for fifteen minutes and won’t ask for a password again until the fifteen minutes are up.</p></blockquote>

<p>This is why you have a sudoers file! You define who&#8217;s allowed to run as
root user and let them run as sudo.</p>

<p><code>su -c 'some command'</code> on the other hand asks for root&#8217;s password.</p>

<h2>Debian Hosts file</h2>

<p>https://www.debian.org/doc/manuals/debian-reference/ch05.en.html#_the_hostname_resolution</p>

<blockquote><p>The IP address 127.0.1.1 in the second line of this example may not be found on some other Unix-like systems. The Debian Installer creates this entry for a system without a permanent IP address as a workaround for some software (e.g., GNOME) as documented in the bug #719621.</p>

<p>The <host_name> matches the hostname defined in the &#8220;/etc/hostname&#8221;.</p>

<p>For a system with a permanent IP address, that permanent IP address should be used here instead of 127.0.1.1.</p>

<p>For a system with a permanent IP address and a fully qualified domain name (FQDN) provided by the Domain Name System (DNS), that canonical <host_name>.<domain_name> should be used instead of just <host_name>.</p></blockquote>

<h2>Loopback</h2>

<p>e.g. localhost; it&#8217;s a way to access a computer&#8217;s own network services
via a network interface. I guess I knew this, but I just didn&#8217;t think
about how it unifies the interface&#8230; e.g. whether it&#8217;s local or remote,
just use IP all the time.</p>

<h2>ifconfig</h2>

<p>&#8220;interface config&#8221;</p>

<h2>debops: run site.yml first</h2>

<p>Don&#8217;t skip this step!</p>

<p>I used <code>rails_deploy</code> before site.yml and things were just ambiguously
missing and I had to patch them up.</p>

<h2>/etc/shadow</h2>

<p>It&#8217;s where all the encrypted passwords live. <code>/etc/passwd</code> is all the
user names, but lots of applications need access to it, so it can&#8217;t be
plaintext. SO in <code>passwd</code> you put &#8216;x&#8217; for password and that causes
<code>/etc/shadow</code> to be looked up.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-05-11T23:38:00-04:00" pubdate data-updated="true">May 11<span>th</span>, 2015</time></div>
	


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/04/15/ember-streams/">
		
			Ember Streams</a>
	</h2>
	<div class="entry-content">
		<h2>Ember Streams</h2>

<p>My goal is to tease out the differences between Ember Streams and Rx.</p>

<p><code>ember-metal/lib/streams/stream.js</code></p>

<p>A stream has subscribers.</p>

<h2>ConnectableObservable</h2>

<p>Wraps a single subscription. Broadcasts events from this single
subscription to all subscribers.</p>

<h2>Rx Disposable</h2>

<p>Anything with a <code>.dispose</code> method. So, what&#8217;s disposable in Rx?</p>

<ul>
<li>subscriptions</li>
<li>observers</li>
</ul>


<p>What&#8217;s it used for?</p>

<ul>
<li>cleaning up some resource after subscriptions no longer need it</li>
<li>generic disposal of no-longer needed objects

<ul>
<li>e.g. internal (non-detach) observers are disposable, but not really
for the purpose of cleaning up some resource, but just making sure
that no more events make it through</li>
</ul>
</li>
</ul>


<p>There isn&#8217;t a Subscription object in Rx, but you can think of the return
value of <code>observable.subscribe</code> to be a &#8220;subscription&#8221;. Technically it&#8217;s
an &#8220;auto-detach&#8221; observer; an auto-detach observer proxies to an
underlying observer. When an auto-detach observer is disposed of, it
disposed of the underyling subscribed observables&#8230; except that an
observable isn&#8217;t a disposable; observables return disposables from their
subscribe methods.</p>

<p>Another way of thinking about this is that, on their own, observables
don&#8217;t act/exist/do anything until they&#8217;re brought to life by a
subscription. There&#8217;s nothing to &#8220;dispose&#8221; of until there is a
subscription. Once someone subscribes, <em>then</em> you have a bunch of stuff
that needs to be cleaned up at some point, hence disposables.</p>

<p>Disposables have their use beyond Rx; <code>dispose</code> is kind of like a
destructor; JavaScript doesn&#8217;t have destructors. Destructors don&#8217;t make
<em>as</em> much sense in garbage-collected languages because their timing is
non-deterministic (often it ends up being more practical to manually
manage this yourself).</p>

<h2>Ember <code>destroy</code></h2>

<p>Ember&#8217;s got &#8220;destroy&#8221;-ables&#8230; <code>destroy</code> methods on objects, and
<code>isDestroyed</code> properties that get set and checked, assertions if things
are called on destroyed objects, etc.</p>

<h3>Ember Object destroy</h3>

<ul>
<li>schedules call to <code>willDestroy</code> hook, meant for subclasses to
implement</li>
<li>aggressively tears down meta object

<ul>
<li>destroys bindings/observers

<ul>
<li>hence anyone listening to events on the obj or binding to values
won&#8217;t get any more updates.</li>
</ul>
</li>
<li>enables eager GC of metadata (it&#8217;s pretty easy in JS/any dynamic
language to keep around references to stuff you don&#8217;t care about any
more; at least with destroy you can eagerly remove things)</li>
</ul>
</li>
</ul>


<h3>EventDispatcher destroy</h3>

<p>Removes all dispatcher-added jQuery event listeners. Calls super.</p>

<h3>Collection View</h3>

<p>Calls super, removes array observers (which live on the content array
and delegate to the collection view), destroy empty view.</p>

<h3>Core View</h3>

<p>First off, CoreView is &#8220;deprecated&#8221; in that it shouldn&#8217;t be used
directly, but Ember.View still extends it.</p>

<p>Calls super, destroys the DOM el (?), some other crap.</p>

<p>Probably doesn&#8217;t make sense to write about until Glimmer.</p>

<h2>Rx Observers</h2>

<p>Class hierarchy</p>

<ul>
<li>Observer

<ul>
<li>AbstractObserver

<ul>
<li>AnonymousObserver</li>
</ul>
</li>
</ul>
</li>
</ul>


<p>You can fulfill the Observer contract without using an Rx Observer
class:</p>

<p>http://jsbin.com/nupafu/11/edit?js,console</p>

<pre><code>console.clear();

var onNext      = () =&gt; { console.log('next'); };
var onError     = () =&gt; { console.log('error'); };
var onCompleted = () =&gt; { console.log('completed'); };

var pojo = { onNext, onError, onCompleted };

var legitObserver = Rx.Observer.create(onNext, onError, onCompleted);
// same thing:
// var legitObserver = new Rx.AnonymousObserver(onNext, onError, onCompleted);

Rx.Observable.range(1,5).subscribe(pojo);
Rx.Observable.range(1,5).subscribe(pojo);

Rx.Observable.range(1,5).subscribe(legitObserver);
Rx.Observable.range(1,5).subscribe(legitObserver);
</code></pre>

<p>The difference is that <code>legitObserver</code>&#8217;s hooks only fire for the first
subscription, and nothing fires for the second; the pojo on the other
hand runs through the range twice. Why? Because <code>Rx.Observer.create</code>
creates an AnonymousObserver, which is an AbstractObserver, and
AbstractObserver sets an <code>isStopped=true</code> flag to prevent further events
from coming through. In other words, generally speaking an observer is
only meant to be attached to one subscription, but if you want the same
object to receive events from multiple observables (and for some stupid
reason you don&#8217;t want to call <code>Observable.prototype.merge</code> then you can
just pass <code>subscribe</code> some pojo with the necessary <code>onNext</code>, <code>onError</code>,
<code>onCompleted</code> methods defined.</p>

<p>Of course you can subscribe the same handler fns and internally two
separate AnonymousObservers will get created, so events from both
subscriptions will fire:</p>

<pre><code>Rx.Observable.range(1,5).subscribe(onNext, onError, onCompleted);
Rx.Observable.range(1,5).subscribe(onNext, onError, onCompleted);
</code></pre>

<h2>JS <code>_super</code> pattern</h2>

<p>Seems obvious, but a decently nice pattern for calling a superclass&#8217;s
method, taken from Ember&#8217;s streams:</p>

<pre><code>merge(SomeSubclass.prototype, {
  /* ... */

  _super$destroy: SomeSuperclass.prototype.destroy,

  destroy() {
    this._super$destroy();

    // do subclass-specific stuff
  }
});
</code></pre>

<h2>Routeable components / attrs / query params</h2>

<pre><code>export default Ember.Route.extend({
  queryParams: {
    page: {
      default: 1,
      // refresh: true,
      // API: infer/generate action name based on param?
    }
  },

  model(params) {
    // params has all params, including QPs
  },

  attrs() {
    return {
      model: this.model(),
      updatePage: this.actions.updatePage
    }
  },

  actions: {
    updatePage(newPage) {
      // this is a manual implementation of the inferred action
      // based on page QP

      // default implementation:
      // when refresh: false (default)
      this.component.set('page', newPage);

      //this.component.set('page', newPage);
    },
  },
});

// articles template
// 



// articles component
export default Ember.Component.extend({
  // implicit attrs

  //attrTypes: {
  //  page: number,
  //},

  page: null,

  // this is called initial render and prop updates
  // (willReceiveAttrs called re-render only)
  willRender(attrs) {
    this.set('page', attrs.page);
  },
});
</code></pre>

<p>Lessons Learned:</p>

<ul>
<li>Route passes in read-only (non-mut) attrs to routeable component</li>
<li><p>This prevents type-writer query params</p>

<p>  // my-input component
  export default Ember.Component.extend({</p>

<pre><code>actions: {
  doSomethingThatChangesValue() {
    // TODO: mut api for changing thing
    attrs.setValue...??
  },
},
</code></pre>

<p>  });</p></li>
</ul>


<h2><code>bashrc</code> and <code>bash_profile</code></h2>

<p>ALWAYS forget the difference between these things. One of them is for
login shells, one is both. Blurg.</p>

<p>Answer:</p>

<ul>
<li><code>.bashrc</code> is read for interactive, non-login shells</li>
<li><code>.bash_profile</code> is read for login shells</li>
<li>Mac OS X uses login shells for its terminals, iTerm included</li>
<li>hence, might make sense to just source <code>.bashrc</code> from <code>.bash_profile</code></li>
</ul>


<p>Also, the meaning of <code>rc</code> isn&#8217;t totally known; it could be &#8220;run
commands&#8221; or &#8220;runtime configuration&#8221; but no one really agrees.</p>

<h2>Glimmer Streams</h2>

<p>KeyStream takes a source obj stream and a path and streams property values
based on the provided key. Can be generated via sourceStream.get(&#8216;wat&#8217;).
A source stream is just a stream of objects. KeyStreams stream property
changes on objects. Changing the underlying object of the source stream
will fire a change event on the KeyStream. KeyStreams watch for changes
using Ember Observers (addObserver/removeObserver)</p>

<p>KeyStreams (among others) have a setSource that changes the underyling
stream of objects; calling setSource will always cause a notify().</p>

<p>Why? mmun says:</p>

<blockquote><p>in order to not notify we would have to eagerly compute the stream value
and compare to the last value</p></blockquote>

<p>So it&#8217;s a tradeoff between minimizing notify spam and losing value laziness.</p>

<p>TODO: how do views use baseContext?</p>

<p>ContextStream is a</p>

<h2>Bash Completion</h2>

<p>http://tldp.org/LDP/abs/html/tabexpansion.html</p>

<ul>
<li>works w Env vars, e.g. <code>$BASH_[tab]</code></li>
<li>use <code>complete</code> to specify rules for a command, e.g. match
filenames, filter by this regex, etc</li>
<li>use <code>compgen</code> to pass shit to a filter fn written in bash
(prefixed by underscore by convention)</li>
</ul>


<h2>why nom/bom/nombom</h2>

<p>Most ember devs have to do something like this due to NPM fidgetries:</p>

<pre><code>alias nombom='npm cache clear &amp;&amp; bower cache clean &amp;&amp; rm -rf node_modules bower_components &amp;&amp; npm install &amp;&amp; bower install'
alias nom='npm cache clear &amp;&amp; rm -rf node_modules &amp;&amp; npm install'
alias bom='bower cache clean &amp;&amp; rm -rf bower_components &amp;&amp; bower install'
</code></pre>

<p>Why is this necessary? Because:</p>

<ol>
<li>Even though npm will take into consideration your project&#8217;s
dependency versions when choosing the version of dependencies of
dependencies, once that package has been installed in <code>node_modules</code>,
even if you bump your project&#8217;s dependencies, that old version will
be cached in deep nestings of <code>node_modules</code>, hence it&#8217;s safest to
nuke <code>node_modules</code>. Afaik only explains the <code>rm -rf node_modules</code>
side of things.</li>
<li>NPM won&#8217;t install a newer version of a dependency if a matching one
exists in the NPM cache (<code>~/.npm/...</code>). Wait, isn&#8217;t this desirable?
Shouldn&#8217;t this be a cue to bump your dependency version?</li>
</ol>


<p>This seems to be the chief reason why nombom is the only way to sane
dependency installation:</p>

<ul>
<li>NPM caches modules by their version, e.g. <code>fstream@1.0.4</code> (these gets
stored in <code>~/.npm/fstream/1.0.4/package.tgz</code></li>
</ul>


<h2>Bash + vim (or whatever)</h2>

<ol>
<li><code>set -o vi</code> so that bash is in Vim mode</li>
<li>Type out a command</li>
<li>Press escape (to leave &#8220;insert mode&#8221;)</li>
<li>press <code>v</code> to open vim w the current command</li>
<li>Save and quit to execute the command</li>
</ol>


<h2>Anamorphism</h2>

<p>http://www.introtorx.com/Content/v1.0.10621.0/05_Filtering.html</p>

<p>Generating a (potentially infinite) vector from a scalar. Also known as
an unfold.</p>

<p>Actually this is better:</p>

<p>http://www.introtorx.com/Content/v1.0.10621.0/08_Transformation.html</p>

<ul>
<li>Ana(morphism) T &#8211;> IObservable<T></li>
<li>Cata(morphism) IObservable<T> &#8211;> T</li>
<li>Bind IObservable<T1> &#8211;> IObservable<T2></li>
</ul>


<h2>Hot observables, connect vs refCount vs singleInstance</h2>

<p>http://jsbin.com/nupafu/20/edit?html,js,console,output</p>

<p>I haven&#8217;t done <code>singleInstance</code> yet, but basically it&#8217;s like
<code>publish().refCount()</code> except it&#8217;ll resubscribe if refcount goes to 0
and then back to 1.</p>

<h2>The ultimate nom nuance</h2>

<p><code>npm</code> will assemble/download all project dependencies with the following
rule:</p>

<ul>
<li>dependencies are installed only into the rootmost dependencies that
specifies that dependency, e.g.</li>
</ul>


<p>If</p>

<pre><code>proj
  - foo
  - bar
    - baz
      - foo
</code></pre>

<p>The <code>npm</code> will <em>NOT</em> install a <code>baz/node_modules/foo</code> but will rather
install a single foo at the root <code>node_modules</code>; the reason this works
in Node land is that <code>require</code> always starts at the current dir and
traverses upward.</p>

<p>Shitty example: start with</p>

<pre><code>proj
  - bar
    - baz
      - foo
</code></pre>

<p>then install at top level foo</p>

<pre><code>proj
  - foo
  - bar
    - baz
      - foo
</code></pre>

<p><code>npm</code> will not remove <code>foo</code> from <code>baz</code>&#8230; you wind up with two different
versions of <code>foo</code>, shadowing each other. Holy shit!!!!!</p>

<p>NPM <code>dedupe</code> would remove the second foo. NPM 3 will probably call
dedupe automatically when you do <code>npm install</code>. But dedupe has its own
issues, not the least of which is that no one knows about it and it&#8217;s
one more thing to tell your team about.</p>

<p>MAIN POINT OF LEARNING:</p>

<p><code>npm</code> delicately stitches things together such that Node&#8217;s folder-bubbling
<code>require</code> resolution semantics can find the packages installed by <code>npm</code>.
It doesn&#8217;t override <code>$LOAD_PATH</code> like Bundler does or anything like
that.</p>

<h2>NPM cherry-pick</h2>

<pre><code>git cherry-pick -x f2c270e8d76e81a1921bbc31777aa3ac570ca87a
</code></pre>

<p>This is how I pulled in a change on an already-merged
<code>idempotent-rerender</code>.</p>

<h2>OnErrorResumeNext</h2>

<p>What a horrible name!</p>

<p>Basically, it&#8217;s <code>concat</code> that automatically recovers from errors.</p>

<p>http://jsbin.com/nupafu/22/edit</p>

<p>http://www.introtorx.com/Content/v1.0.10621.0/11_AdvancedErrorHandling.html</p>

<blockquote><p>Just the title of this section will send a shudder down the spines of old VB developers! In Rx, there is an extension method called OnErrorResumeNext that has similar semantics to the VB keywords/statement that share the same name.</p>

<p>Just as the OnErrorResumeNext keyword warranted mindful use in VB, so should it be used with caution in Rx. It will swallow exceptions quietly and can leave your program in an unknown state.</p></blockquote>

<h2>Observable#finally invoked even on dispose</h2>

<p>http://jsbin.com/nupafu/24/edit?html,js,console,output</p>

<h2>ConnectableObservables can reconnect</h2>

<p>http://jsbin.com/nupafu/25/edit?html,js,console,output</p>

<pre><code>var c = Rx.Observable.interval(500).publish();

c.subscribe((v) =&gt; {
  console.log(v);
});

// returns a disposable that disconnects.
var s = c.connect();

setTimeout(() =&gt; {
  s.dispose();
  s = c.connect();
}, 1200);
</code></pre>

<h2>Multicast</h2>

<p>Didn&#8217;t understand this til I understood <code>publishLast()</code> and <code>replay()</code>,
which basically apply <code>multicast</code> functionality through async subject
and replay subject, respectively. Basically replay and async subjects
just define different forms of caching, and if you want to share that
functionality with connectable observable then you wanna use multicast.</p>

<pre><code>.Publish() = .Multicast(new Subject&lt;T&gt;)
.PublishLast() = .Multicast(new AsyncSubject&lt;T&gt;)
.Replay() = .Multicast(new ReplaySubject&lt;T&gt;)
</code></pre>

<h2>Windows</h2>

<p>I&#8217;ve talked about before, grokking it better now:</p>

<p>http://jsbin.com/nupafu/27/edit?js,console,output</p>

<pre><code>var o = Rx.Observable.range(5, 20);

// HOT 
var shared = o.publish().refCount();

var openings = shared;//.filter((_, idx) =&gt; idx % 3 === 0);

shared.window(openings, () =&gt; 
  shared.filter((v, idx) =&gt; v % 5 === 0)
).selectMany((obs) =&gt; {
  return obs.toArray();
}).subscribe((arr) =&gt; {
  console.log(arr);
});
</code></pre>

<p>Takeaways:</p>

<ul>
<li>closing selector gets passed the value emitted by windowOpenings that
caused it to be opened in the first place.</li>
<li>if the closing selector is based on the same source data stream, you
almost certainly want to use <code>publish().refCount()</code>, or at least make
sure the source stream is hot, or if it&#8217;s cold it doesn&#8217;t expensively
re-create / duplicate some underlying resource</li>
</ul>


<h2>Subscribing inside Observer.create()</h2>

<p>The contract for Observer.create is to</p>

<ul>
<li>fire <code>onNext*(onComplete|OnError)?</code> on the observer passed in</li>
<li>return a disposable</li>
</ul>


<p>Based on that, the following is a perfectly valid way to alias an
observable:</p>

<p>http://jsbin.com/nupafu/30/edit</p>

<pre><code>var proxy = Rx.Observable.create((o) =&gt; {
  return Rx.Observable.interval(200).subscribe(o);
});

proxy.subscribe((v) =&gt; {
  console.log(v);
});
</code></pre>

<p><code>proxy</code> behaves just like <code>interval</code>.</p>

<h2>C# <code>+=</code> and <code>-=</code> event subscription syntax</h2>

<pre><code>this.Click += (s,e) =&gt; { MessageBox.Show(
   ((MouseEventArgs)e).Location.ToString());};
</code></pre>

<h2><code>Either&lt;LeftT, RightT&gt;</code></h2>

<p>In Rxx, <code>Either</code> is used a bunch to imply a broadcast of data from
either source sequence A or source sequence B; one nice use case of it
is how their <code>Retry</code> method works.</p>

<p>http://rxx.codeplex.com/discussions/401272</p>

<p>Basically, vanilla Rx retry disposes of the error that causes the retry
to happen, which means it&#8217;s trick to do logging in a nice composable
way.</p>

<h2>Apple IP is <code>17.***.***.***</code></h2>

<p>http://tapity.com/17-the-secret-to-finding-out-how-many-apple-employees-dig-your-stuff/</p>

<p>https://support.apple.com/en-us/HT203609</p>

<blockquote><p>The entire 17.0.0.0/8 address block is assigned to Apple</p></blockquote>

<p>So you can check your logs to see if Apple&#8217;s snooping your shit.</p>

<h2><code>embedded.mobileprovision</code></h2>

<p>It is present in ALL <code>.ipa</code>s generated by XCode <em>including App Store
builds</em>, but by the time you download <em>from the App Store</em>, it has been
stripped out.</p>

<h2>RxJava lifts, other things</h2>

<p>https://speakerdeck.com/dlew/reactive-extensions-beyond-the-basics</p>

<ul>
<li>hot sequences have no subscription side effects</li>
<li><p>cold sequences may have subscription side effects</p></li>
<li><p>Observable.just(&#8220;1&#8221;)</p>

<ul>
<li>cold, because generates that string every subscription</li>
</ul>
</li>
<li>Observable.interval()

<ul>
<li>cold, no duh</li>
</ul>
</li>
<li>ReplaySubject

<ul>
<li>cold???</li>
<li>hot if you&#8217;re first subscriber</li>
<li>cold if there are items to replay, and then hot thereafter</li>
</ul>
</li>
</ul>


<h2>Redis: why use hash?</h2>

<p>Why do</p>

<pre><code>HSET somehash key val
</code></pre>

<p>when you can do HGET</p>

<h2>redistogo disables <code>CONFIG</code> command</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>1:39 PM &lt;machty&gt; any idea why on redis 2.8.11 i'm getting ERR unknown command 'config' ? docs say config command exists since 2.0.0
</span><span class='line'>1:48 PM &lt;machty&gt; actually i think it's because CONFIG is disabled by redistogo service... unfortunately both CONFIG GET and CONFIG SET :/
</span><span class='line'>1:55 PM &lt;xxxx&gt; machty: I actually work for Redistogo
</span><span class='line'>1:55 PM &lt;xxxx&gt; We do disable it indeed
</span><span class='line'>1:56 PM &lt;machty&gt; xxxx: ah, i guess there's no way to dynamically get maxmemory? was thinking of using it for alerts
</span><span class='line'>1:56 PM &lt;xxxx&gt; Unfortunately not, there was talk of working on API for it but that development kind of got halted</span></code></pre></td></tr></table></div></figure>


<p>Apparently a lot of effort is being shifted from redistogo to
ObjectRocket redis, which:</p>

<ul>
<li>doesn&#8217;t disable CONFIG</li>
<li>has high availability (HA) enabled by default via sentinels</li>
<li>http://redis.io/topics/sentinel</li>
</ul>


<h2>nethack</h2>

<p>What is it?</p>

<h2>Logstash</h2>

<p>https://www.youtube.com/watch?v=RuUFnog29M4</p>

<ul>
<li><a href="http://www.nagios.org/">nagios</a>: infrastructure monitoring</li>
<li>log = timestamp + data</li>
<li>Logstash

<ul>
<li>open source</li>
<li>config file is nginx-ish</li>
<li>output graphs and a bunch of other things</li>
<li>use grok

<ul>
<li>write patterns, and give them name</li>
<li>reusable regex</li>
<li>comes w 100 patterns</li>
<li>no need for regex skills</li>
</ul>
</li>
<li>data filter included to handle all varieties of timestamp format</li>
<li>stop inventing time formats</li>
<li>multiline filter for errors w stack trace</li>
<li>gettimeofday</li>
<li>NTP

<ul>
<li>network time protocol, used for syncing servers</li>
<li>if apache uses gettimeofday</li>
</ul>
</li>
<li>feature

<ul>
<li>transport and process logs to and from anywhere

<ul>
<li>get them in analyzable format</li>
</ul>
</li>
<li>provide search and analytics</li>
</ul>
</li>
<li>community

<ul>
<li>kibana: web interface for logstache</li>
<li>logstash-cli: search / analytics from commandline</li>
</ul>
</li>
<li>dreamhost deployment

<ul>
<li>20k apache events/sec peak</li>
<li>250 mil events/day</li>
<li>75gb day</li>
<li>160 web servers</li>
<li>7 logstach / elasticsearch servers</li>
</ul>
</li>
</ul>
</li>
</ul>


<h2>ELK</h2>

<p>http://blog.qbox.io/indexing-heroku-logs-into-elasticsearch-with-logstash</p>

<ul>
<li>elastic search

<ul>
<li>searchable database</li>
</ul>
</li>
<li>logstash

<ul>
<li>parses/processes logs from many sources, stores in centralized location</li>
</ul>
</li>
<li>kibana</li>
</ul>


<p>https://www.elastic.co/webinars/elk-stack-devops-environment</p>

<ul>
<li>installation

<ul>
<li>download, untar, and run</li>
</ul>
</li>
</ul>


<p>So who the fuck uses ELK stack? Just enormous companies that manage
their own custom infrastructures?</p>

<p>Answer: anyone who does enough devops to</p>

<ul>
<li>be smart enough to set it up</li>
<li>know the pain of living without it</li>
</ul>


<p>Logstash is generally meant to live on the machine that&#8217;s producing the
logs, and then it can forward it on to an elasticsearch cluster..</p>

<h2>Ruby logging</h2>

<blockquote><p>A flexible logging library for use in Ruby programs based on the design of Java&#8217;s log4j library.</p></blockquote>

<p>https://github.com/TwP/logging</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-04-15T14:13:00-04:00" pubdate data-updated="true">Apr 15<span>th</span>, 2015</time></div>
	


	
</div></article>

<nav id="pagenavi">
    
    
        <a href="/blog/page/2/" class="next">Next</a>
    
    <div class="center"><a href="/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Copyright &copy; 2015

    Alex Matchneer

<br>
Powered by Octopress.
</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'usefuldude';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-49928757-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



</body>
</html>

